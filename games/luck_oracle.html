<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="dark light" />
  <title>運氣占卜遊戲（單機大全）</title>
  <style>
    :root{
      --bg0:#0b0d12;
      --bg1:#0f1320;
      --card:#131a2a;
      --text:#e9eefc;
      --muted:#aab6d6;
      --line:rgba(255,255,255,.08);
      --glow:rgba(146,197,255,.22);
      --good:rgba(90, 230, 170, .18);
      --warn:rgba(255, 210, 110, .18);
      --bad: rgba(255, 120, 140, .18);
      --shadow: 0 14px 40px rgba(0,0,0,.45);
      --r:18px;
      --r2:22px;
      --pad:14px;
      --tap: 52px;
      --font: system-ui, -apple-system, "Segoe UI", "PingFang TC", "Microsoft JhengHei", sans-serif;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family:var(--font);
      background:
        radial-gradient(1200px 800px at 20% -10%, rgba(120,170,255,.16), transparent 60%),
        radial-gradient(1000px 700px at 90% 0%, rgba(255,160,220,.10), transparent 55%),
        radial-gradient(900px 700px at 30% 100%, rgba(100,255,200,.08), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      color:var(--text);
      overflow-x:hidden;
    }
    .safeTop{ padding-top: env(safe-area-inset-top); }
    .safeBot{ padding-bottom: env(safe-area-inset-bottom); }
    .app{ min-height:100%; display:flex; flex-direction:column; }

    header{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(10,12,18,.88), rgba(10,12,18,.55));
      border-bottom:1px solid var(--line);
    }
    .topbar{ display:flex; align-items:center; gap:10px; padding: 12px var(--pad); }
    .brand{ display:flex; flex-direction:column; min-width:0; }
    .brand .t1{ font-weight:750; letter-spacing:.3px; line-height:1.1; font-size:16px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .brand .t2{ margin-top:2px; color:var(--muted); font-size:12px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .spacer{ flex:1; }
    .iconbtn{
      height:40px; min-width:40px;
      border-radius:14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      color:var(--text);
      display:inline-flex; align-items:center; justify-content:center;
      box-shadow: 0 8px 22px rgba(0,0,0,.25);
      cursor:pointer;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
    }
    .iconbtn:active{ transform: translateY(1px); }

    main{
      width:100%;
      max-width:980px;
      margin:0 auto;
      padding: 14px var(--pad) 90px;
    }

    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius: var(--r2);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .panelHead{
      padding: 14px 14px 10px;
      border-bottom:1px solid var(--line);
      display:flex; align-items:flex-start; gap:10px;
    }
    .panelHead .h{ font-weight:800; font-size:15px; line-height:1.2; }
    .panelHead .sub{ color:var(--muted); font-size:12px; margin-top:4px; line-height:1.4; }
    .panelBody{ padding: 12px 14px 14px; }

    .grid{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; }
    @media (min-width: 720px){ .grid{ grid-template-columns: repeat(3, 1fr); } }

    .card{
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border-radius: var(--r);
      padding: 12px;
      box-shadow: 0 10px 28px rgba(0,0,0,.28);
      cursor:pointer;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
      position:relative; overflow:hidden;
      min-height: 112px;
    }
    .card::before{
      content:""; position:absolute; inset:-30px;
      background: radial-gradient(260px 160px at 10% 10%, rgba(140,190,255,.14), transparent 60%);
      pointer-events:none;
    }
    .card:active{ transform: translateY(1px); }
    .card .title{ font-weight:800; font-size:14px; letter-spacing:.2px; line-height:1.2; position:relative; z-index:1; }
    .card .desc{ margin-top:6px; color:var(--muted); font-size:12px; line-height:1.35; position:relative; z-index:1; }

    .pill{
      display:inline-flex; align-items:center; gap:6px;
      padding: 6px 10px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      color:var(--muted);
      font-size:12px; line-height:1;
      user-select:none;
      white-space:nowrap;
    }
    .row{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    .btn{
      height: var(--tap);
      padding: 0 14px;
      border-radius: 16px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color:var(--text);
      font-weight:700;
      letter-spacing:.2px;
      cursor:pointer;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      box-shadow: 0 10px 26px rgba(0,0,0,.24);
    }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{
      background: linear-gradient(180deg, rgba(120,170,255,.26), rgba(120,170,255,.10));
      border-color: rgba(120,170,255,.30);
      box-shadow: 0 14px 34px rgba(40,90,180,.18);
    }
    .btn.danger{
      background: linear-gradient(180deg, rgba(255,120,140,.18), rgba(255,120,140,.08));
      border-color: rgba(255,120,140,.28);
    }
    .btn.ghost{ background: rgba(255,255,255,.03); box-shadow:none; }
    .btn.small{ height: 42px; border-radius: 14px; font-weight:700; }

    .bottomNav{
      position:fixed; left:0; right:0; bottom:0; z-index:60;
      padding: 10px var(--pad) calc(10px + env(safe-area-inset-bottom));
      background: linear-gradient(180deg, rgba(10,12,18,0), rgba(10,12,18,.86) 30%, rgba(10,12,18,.96));
      border-top: 1px solid rgba(255,255,255,.06);
      backdrop-filter: blur(12px);
    }
    .bottomNav .bar{ max-width:980px; margin:0 auto; display:flex; gap:10px; }
    .tab{
      flex:1; height: 52px;
      border-radius: 18px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      color:var(--muted);
      font-weight:800;
      letter-spacing:.2px;
      display:flex; align-items:center; justify-content:center;
      cursor:pointer; user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .tab.active{
      color:var(--text);
      background: linear-gradient(180deg, rgba(140,190,255,.18), rgba(255,255,255,.04));
      border-color: rgba(140,190,255,.22);
      box-shadow: 0 14px 32px rgba(0,0,0,.22);
    }
    .tab:active{ transform: translateY(1px); }

    .overlay{
      position:fixed; inset:0;
      background: rgba(0,0,0,.56);
      display:none; align-items:flex-end;
      z-index:100;
      padding: 14px;
      padding-bottom: calc(14px + env(safe-area-inset-bottom));
    }
    .overlay.show{ display:flex; }
    .sheet{
      width:100%; max-width:680px; margin:0 auto;
      border-radius: 22px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(16,20,32,.94), rgba(10,12,18,.96));
      box-shadow: 0 22px 60px rgba(0,0,0,.55);
      overflow:hidden;
      transform: translateY(10px);
      animation: popIn .18s ease-out forwards;
    }
    @keyframes popIn{ to{ transform: translateY(0); } }
    .sheetTop{
      padding: 12px 14px;
      border-bottom:1px solid var(--line);
      display:flex; align-items:center; gap:10px;
    }
    .sheetTop .title{ font-weight:900; letter-spacing:.2px; }
    .sheetTop .meta{ margin-left:auto; color:var(--muted); font-size:12px; white-space:nowrap; }
    .sheetBody{ padding: 14px; }

    .resultBox{
      border:1px solid var(--line);
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      padding: 14px;
      position:relative;
      overflow:hidden;
    }
    .resultBox::before{
      content:"";
      position:absolute; inset:-40px;
      background: radial-gradient(320px 220px at 20% 20%, var(--glow), transparent 60%);
      pointer-events:none;
    }
    .resultTitle{
      font-weight:950;
      font-size:16px;
      letter-spacing:.2px;
      position:relative; z-index:1;
      line-height:1.2;
    }
    .resultText{
      margin-top:10px;
      color:var(--text);
      font-size:14px;
      line-height:1.65;
      position:relative; z-index:1;
      white-space:pre-wrap;
      word-break:break-word;
    }
    .hint{ margin-top:10px; color:var(--muted); font-size:12px; line-height:1.5; }
    .sheetActions{ margin-top:12px; display:flex; gap:10px; flex-wrap:wrap; }
    .sheetActions .btn{ flex:1; min-width: 120px; }

    .shake{ animation: shake .42s ease-in-out; }
    @keyframes shake{
      0%{ transform: translateX(0) rotate(0); }
      15%{ transform: translateX(-6px) rotate(-1deg); }
      35%{ transform: translateX(6px) rotate(1deg); }
      55%{ transform: translateX(-5px) rotate(-1deg); }
      75%{ transform: translateX(5px) rotate(1deg); }
      100%{ transform: translateX(0) rotate(0); }
    }
    .flip{ transform-style:preserve-3d; animation: flip .55s ease-in-out; }
    @keyframes flip{
      0%{ transform: rotateY(0deg); }
      45%{ transform: rotateY(100deg); }
      55%{ transform: rotateY(80deg); }
      100%{ transform: rotateY(0deg); }
    }
    .spin{ animation: spin 1.05s cubic-bezier(.16,.86,.24,1); }
    @keyframes spin{
      0%{ transform: rotate(0deg) scale(1); }
      60%{ transform: rotate(820deg) scale(1.03); }
      100%{ transform: rotate(1080deg) scale(1); }
    }

    .list{ display:flex; flex-direction:column; gap:10px; }
    .item{
      border:1px solid var(--line);
      border-radius: 16px;
      padding: 12px;
      background: rgba(255,255,255,.03);
    }
    .item .top{ display:flex; align-items:flex-start; gap:10px; }
    .badge{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      color:var(--muted);
      font-weight:800;
      font-size:12px;
      line-height:1;
      white-space:nowrap;
    }
    .item .ttl{ font-weight:900; line-height:1.25; }
    .item .time{ margin-left:auto; color:var(--muted); font-size:12px; white-space:nowrap; }
    .item .txt{ margin-top:8px; color:var(--text); font-size:13px; line-height:1.55; white-space:pre-wrap; word-break:break-word; }
    .item .ops{ margin-top:10px; display:flex; gap:8px; flex-wrap:wrap; }
    .toggleRow{
      display:flex; align-items:center; gap:10px;
      padding: 10px 0;
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .toggleRow:last-child{ border-bottom:0; }
    .toggleRow .lbl{ flex:1; min-width:0; }
    .toggleRow .lbl .k{ font-weight:900; }
    .toggleRow .lbl .d{ margin-top:4px; color:var(--muted); font-size:12px; line-height:1.4; }
    .switch{
      width:54px; height:32px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      position:relative;
      cursor:pointer;
      flex:0 0 auto;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
    }
    .switch::after{
      content:"";
      position:absolute; top:3px; left:3px;
      width:26px; height:26px;
      border-radius:50%;
      background: rgba(255,255,255,.90);
      box-shadow: 0 10px 18px rgba(0,0,0,.25);
      transition: .16s ease;
    }
    .switch.on{
      background: linear-gradient(180deg, rgba(140,190,255,.28), rgba(140,190,255,.12));
      border-color: rgba(140,190,255,.28);
    }
    .switch.on::after{ left: 25px; }

    .toast{
      position:fixed;
      left:50%;
      bottom: 80px;
      transform: translateX(-50%) translateY(12px);
      background: rgba(10,12,18,.92);
      border:1px solid rgba(255,255,255,.10);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 14px;
      box-shadow: 0 18px 40px rgba(0,0,0,.45);
      opacity:0;
      pointer-events:none;
      z-index:200;
      transition: .18s ease;
      max-width: 92vw;
      font-size: 13px;
      line-height:1.4;
    }
    .toast.show{ opacity:1; transform: translateX(-50%) translateY(0); }
    .mono{ font-variant-numeric: tabular-nums; }
    .hr{ height:1px; background: rgba(255,255,255,.06); margin: 10px 0; }

    .sigil{
      width: 72px; height:72px;
      border-radius: 20px;
      border:1px solid var(--line);
      background: radial-gradient(38px 38px at 28% 22%, rgba(140,190,255,.22), transparent 60%),
                  radial-gradient(34px 34px at 75% 75%, rgba(255,160,220,.18), transparent 60%),
                  rgba(255,255,255,.03);
      box-shadow: 0 16px 30px rgba(0,0,0,.28);
      flex:0 0 auto;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:950;
      letter-spacing:.5px;
      color: rgba(255,255,255,.86);
      user-select:none;
    }
    .sigil small{
      display:block;
      font-size: 11px;
      color: rgba(255,255,255,.62);
      margin-top:2px;
      letter-spacing:0;
      font-weight:800;
    }
    .kpiRow{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .kpi{
      flex:1; min-width: 140px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.03);
      border-radius: 16px;
      padding: 10px 12px;
    }
    .kpi .k{ color:var(--muted); font-size:12px; }
    .kpi .v{ font-weight:950; margin-top:6px; font-size:16px; }
  

/* ===========================
   Reveal Animations (per game)
=========================== */
.resultWrap{ width:100%; }
.resultTop{ display:flex; justify-content:space-between; align-items:center; margin: 6px 2px 10px; gap:10px;}
.resultTop .chip{ padding:6px 10px; border-radius:999px; background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.10); }
.resultTop .time{ opacity:.7; font-size:12px; }

.resultCard{
  position: relative;
  border-radius: 18px;
  padding: 18px;
  background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: 0 10px 30px rgba(0,0,0,.35) inset, 0 12px 40px rgba(0,0,0,.25);
  overflow: hidden;
}

.resultMain .resultTitle{ font-size:20px; font-weight:900; letter-spacing:.5px; margin-bottom: 10px;}
.resultText{ white-space: pre-wrap; line-height:1.55; margin: 0; font-size:14px; opacity:.92;}
.hint{ margin-top: 10px; font-size:12px; opacity:.65;}

.revealLayer{
  position:absolute; inset:0;
  display:flex; align-items:center; justify-content:center;
  background: radial-gradient(800px 280px at 50% 40%, rgba(255,255,255,.10), rgba(0,0,0,.0) 55%) ,
              rgba(0,0,0,.35);
  backdrop-filter: blur(6px);
  transition: opacity .45s ease, transform .45s ease;
}
.revealLayer.run{ opacity:1; }
.revealLayer.out{ opacity:0; transform: scale(1.03); }

.revealFx{ text-align:center; padding: 10px 14px; }
.revealTitle{ font-size:18px; font-weight:900; opacity:.95; margin-bottom:6px;}
.revealSub{ font-size:13px; opacity:.75; }

.revealFx:before{ content:""; display:none; }

/* Different "feel" per game */
.reveal-lot .revealFx:before{ animation: fxScroll 1.05s ease-in-out infinite; }
.reveal-doors .revealFx:before{ animation: fxDoor 1.15s ease-in-out infinite; }
.reveal-tarot .revealFx:before{ animation: fxFlip 1.25s ease-in-out infinite; }
.reveal-orb .revealFx:before{ animation: fxPulse 1.30s ease-in-out infinite; }
.reveal-wheel .revealFx:before{ animation: fxSpin 1.05s linear infinite; }
.reveal-npc .revealFx:before{ animation: fxType 0.9s steps(6,end) infinite; }
.reveal-gacha .revealFx:before{ animation: fxBurst 1.45s ease-in-out infinite; }
.reveal-todo .revealFx:before{ animation: fxStamp 1.0s ease-in-out infinite; }
.reveal-ritual .revealFx:before{ animation: fxSpark 1.25s ease-in-out infinite; }
.reveal-dice .revealFx:before{ animation: fxRoll 1.05s ease-in-out infinite; }
.reveal-reverse .revealFx:before{ animation: fxGlitch 1.2s linear infinite; }


/* Reveal widgets (per game, readable & themed) */
.revealWidget{ width:220px; height:140px; margin: 10px auto 0; position:relative; }
.revealWidget *{ box-sizing:border-box; }
.revealWidget .glow{ position:absolute; inset:-10px; border-radius:999px;
  background: radial-gradient(circle at 50% 55%, rgba(255,255,255,.14), rgba(255,255,255,0) 62%);
  filter: blur(0.2px);
  opacity:.85;
}
.rw-lot .tube{ position:absolute; left:82px; top:8px; width:56px; height:118px; border-radius:22px;
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.03));
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset, 0 16px 32px rgba(0,0,0,.35);
}
.rw-lot .cap{ position:absolute; left:74px; top:0; width:72px; height:20px; border-radius:999px;
  background: rgba(255,255,255,.10); box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset;
}
.rw-lot .slip{ position:absolute; left:96px; top:40px; width:28px; height:80px; border-radius:10px;
  background: linear-gradient(180deg, rgba(255,255,255,.20), rgba(255,255,255,.06));
  transform-origin: 50% 10%;
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset;
}
.rw-lot{ animation: lotShake 0.75s ease-in-out infinite; }
.rw-lot .slip{ animation: lotSlip 0.75s ease-in-out infinite; }

.rw-doors .door{ position:absolute; top:22px; width:62px; height:96px; border-radius:12px;
  background: linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.03));
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset, 0 18px 30px rgba(0,0,0,.35);
  transform-origin: 8px 50%;
}
.rw-doors .door:after{ content:""; position:absolute; right:10px; top:46px; width:7px; height:7px; border-radius:50%;
  background: rgba(255,255,255,.35);
}
.rw-doors .door.d1{ left:18px; }
.rw-doors .door.d2{ left:79px; }
.rw-doors .door.d3{ left:140px; }
.rw-doors .light{ position:absolute; inset:18px 10px 18px 10px; border-radius:18px;
  background: radial-gradient(circle at 50% 70%, rgba(255,255,255,.18), rgba(255,255,255,0) 62%);
  opacity:.0;
}
.rw-doors .door{ animation: doorPeek 1.05s ease-in-out infinite; }
.rw-doors .door.d2{ animation-delay: .12s; }
.rw-doors .door.d3{ animation-delay: .24s; }

.rw-tarot .deck{ position:absolute; left:74px; top:30px; width:82px; height:100px; border-radius:16px;
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04));
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset, 0 16px 30px rgba(0,0,0,.35);
}
.rw-tarot .card{ position:absolute; left:82px; top:22px; width:66px; height:92px; border-radius:14px;
  background: radial-gradient(circle at 30% 20%, rgba(255,255,255,.22), rgba(255,255,255,.05) 62%);
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset, 0 16px 30px rgba(0,0,0,.35);
  transform-style:preserve-3d;
  animation: cardFlip 1.1s ease-in-out infinite;
}
.rw-tarot .card:before{ content:""; position:absolute; inset:10px; border-radius:12px;
  border: 1px dashed rgba(255,255,255,.18);
}

.rw-orb .ball{ position:absolute; left:68px; top:18px; width:92px; height:92px; border-radius:999px;
  background: radial-gradient(circle at 30% 25%, rgba(255,255,255,.22), rgba(255,255,255,.06) 60%, rgba(255,255,255,.03));
  box-shadow: 0 0 0 1px rgba(255,255,255,.12) inset, 0 22px 44px rgba(0,0,0,.38);
  overflow:hidden;
}
.rw-orb .mist{ position:absolute; inset:-30px; background: radial-gradient(circle at 40% 55%, rgba(255,255,255,.18), rgba(255,255,255,0) 60%);
  filter: blur(0.6px);
  animation: orbSwirl 1.35s ease-in-out infinite;
}
.rw-orb .base{ position:absolute; left:66px; top:102px; width:96px; height:26px; border-radius:16px;
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.03));
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset;
}

.rw-wheel .wheel{ position:absolute; left:62px; top:16px; width:96px; height:96px; border-radius:999px;
  background: conic-gradient(from 0deg, rgba(255,255,255,.18), rgba(255,255,255,.06), rgba(255,255,255,.14), rgba(255,255,255,.05));
  box-shadow: 0 0 0 1px rgba(255,255,255,.12) inset, 0 18px 34px rgba(0,0,0,.38);
  animation: wheelSpin 0.9s linear infinite;
}
.rw-wheel .hub{ position:absolute; left:104px; top:58px; width:18px; height:18px; border-radius:50%;
  background: rgba(255,255,255,.30);
}
.rw-wheel .ptr{ position:absolute; left:108px; top:6px; width:0; height:0;
  border-left:10px solid transparent; border-right:10px solid transparent; border-bottom:18px solid rgba(255,255,255,.30);
  filter: drop-shadow(0 6px 10px rgba(0,0,0,.35));
}

.rw-dice .cube{ position:absolute; left:78px; top:28px; width:64px; height:64px; border-radius:16px;
  background: linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.05));
  box-shadow: 0 0 0 1px rgba(255,255,255,.12) inset, 0 18px 34px rgba(0,0,0,.38);
  animation: diceRoll 0.85s ease-in-out infinite;
}
.rw-dice .pip{ position:absolute; width:8px; height:8px; border-radius:50%; background: rgba(255,255,255,.35); }
.rw-dice .p1{ left:28px; top:28px; }
.rw-dice .p2{ left:14px; top:14px; }
.rw-dice .p3{ left:42px; top:42px; }

.rw-gacha .cards{ position:absolute; left:42px; top:28px; width:136px; height:96px; }
.rw-gacha .c{ position:absolute; width:48px; height:70px; border-radius:12px;
  background: radial-gradient(circle at 30% 20%, rgba(255,255,255,.20), rgba(255,255,255,.05) 70%);
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset, 0 16px 28px rgba(0,0,0,.35);
  transform-origin: 50% 90%;
  animation: gachaFan 1.05s ease-in-out infinite;
}
.rw-gacha .c:nth-child(1){ left:0; transform: rotate(-18deg); }
.rw-gacha .c:nth-child(2){ left:28px; transform: rotate(-6deg); animation-delay:.05s; }
.rw-gacha .c:nth-child(3){ left:56px; transform: rotate(6deg); animation-delay:.10s; }
.rw-gacha .c:nth-child(4){ left:84px; transform: rotate(18deg); animation-delay:.15s; }
.rw-gacha .spark{ position:absolute; left:0; top:0; right:0; bottom:0; pointer-events:none;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.18), rgba(255,255,255,0) 55%);
  opacity:.0; animation: sparkPop 1.05s ease-in-out infinite;
}

.rw-todo .stamp{ position:absolute; left:58px; top:34px; width:104px; height:72px; border-radius:18px;
  border:2px solid rgba(255,255,255,.18);
  box-shadow: 0 10px 28px rgba(0,0,0,.35);
  transform: rotate(-6deg);
  animation: stampHit 0.85s ease-in-out infinite;
}
.rw-todo .bar{ position:absolute; left:18px; top:32px; width:68px; height:8px; border-radius:999px; background: rgba(255,255,255,.22); }
.rw-todo .bar.b2{ top:46px; width:52px; opacity:.75; }

.rw-ritual .ring{ position:absolute; left:56px; top:16px; width:108px; height:108px; border-radius:999px;
  border: 2px solid rgba(255,255,255,.16);
  box-shadow: 0 0 0 1px rgba(255,255,255,.06) inset, 0 18px 34px rgba(0,0,0,.38);
  animation: ritualSpin 1.2s linear infinite;
}
.rw-ritual .sig{ position:absolute; left:0; top:0; right:0; bottom:0;
  background: conic-gradient(from 0deg, rgba(255,255,255,.16), rgba(255,255,255,0), rgba(255,255,255,.10), rgba(255,255,255,0));
  border-radius:999px;
  opacity:.85;
}

.rw-npc .bubble{ position:absolute; left:36px; top:34px; width:148px; height:72px; border-radius:18px;
  background: rgba(255,255,255,.07);
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset, 0 14px 28px rgba(0,0,0,.35);
}
.rw-npc .dot{ position:absolute; top:34px; width:10px; height:10px; border-radius:50%; background: rgba(255,255,255,.35);
  animation: npcDots 0.75s ease-in-out infinite;
}
.rw-npc .d1{ left:68px; }
.rw-npc .d2{ left:98px; animation-delay:.12s; }
.rw-npc .d3{ left:128px; animation-delay:.24s; }

.rw-reverse .crack{ position:absolute; left:44px; top:22px; width:132px; height:96px; border-radius:18px;
  background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset, 0 18px 34px rgba(0,0,0,.38);
  overflow:hidden;
}
.rw-reverse .ink{ position:absolute; inset:-20px; background: radial-gradient(circle at 40% 55%, rgba(0,0,0,.55), rgba(0,0,0,0) 60%);
  animation: inkCreep 1.0s ease-in-out infinite;
  mix-blend-mode: multiply;
  opacity:.55;
}
.rw-reverse .scan{ position:absolute; left:0; right:0; height:10px; top:-10px;
  background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,.20), rgba(255,255,255,0));
  animation: scanLine 0.95s linear infinite;
  opacity:.6;
}

/* Keyframes for widgets */
@keyframes lotShake{ 0%{ transform:rotate(-3deg) translateY(0);} 50%{ transform:rotate(3deg) translateY(2px);} 100%{ transform:rotate(-3deg) translateY(0);} }
@keyframes lotSlip{ 0%{ transform:translateY(0) rotate(-4deg);} 50%{ transform:translateY(10px) rotate(6deg);} 100%{ transform:translateY(0) rotate(-4deg);} }
@keyframes doorPeek{ 0%{ transform: perspective(300px) rotateY(0deg);} 55%{ transform: perspective(300px) rotateY(-28deg);} 100%{ transform: perspective(300px) rotateY(0deg);} }
@keyframes cardFlip{ 0%{ transform: translateY(0) rotateY(0deg);} 50%{ transform: translateY(-6px) rotateY(180deg);} 100%{ transform: translateY(0) rotateY(360deg);} }
@keyframes orbSwirl{ 0%{ transform:translate(-10px,8px) rotate(0deg);} 50%{ transform:translate(12px,-8px) rotate(20deg);} 100%{ transform:translate(-10px,8px) rotate(0deg);} }
@keyframes wheelSpin{ from{ transform:rotate(0deg);} to{ transform:rotate(360deg);} }
@keyframes diceRoll{ 0%{ transform:rotate(0deg) translateY(0);} 50%{ transform:rotate(18deg) translateY(-6px);} 100%{ transform:rotate(0deg) translateY(0);} }
@keyframes gachaFan{ 0%,100%{ transform: translateY(0) scale(1);} 50%{ transform: translateY(-6px) scale(1.02);} }
@keyframes sparkPop{ 0%,100%{ opacity:.10;} 50%{ opacity:.28;} }
@keyframes stampHit{ 0%{ transform:translateY(-8px) rotate(-6deg); opacity:.85;} 45%{ transform:translateY(2px) rotate(-6deg); opacity:1;} 100%{ transform:translateY(-8px) rotate(-6deg); opacity:.85;} }
@keyframes ritualSpin{ from{ transform:rotate(0deg);} to{ transform:rotate(360deg);} }
@keyframes npcDots{ 0%,100%{ transform:translateY(0); opacity:.45;} 50%{ transform:translateY(-6px); opacity:.95;} }
@keyframes inkCreep{ 0%{ transform:translate(-10px,10px) scale(1);} 50%{ transform:translate(12px,-10px) scale(1.05);} 100%{ transform:translate(-10px,10px) scale(1);} }
@keyframes scanLine{ 0%{ top:-12px;} 100%{ top:120px;} }

@keyframes fxScroll{ 0%{ transform: translateY(0) scale(1);} 50%{ transform: translateY(-8px) scale(1.03);} 100%{ transform: translateY(0) scale(1);} }
@keyframes fxDoor{ 0%{ transform: scale(1); box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset, 0 12px 40px rgba(0,0,0,.35);} 50%{ transform: scale(1.04); box-shadow: 0 0 0 1px rgba(255,255,255,.14) inset, 0 18px 60px rgba(0,0,0,.45);} 100%{ transform: scale(1);} }
@keyframes fxFlip{ 0%{ transform: rotateY(0deg) scale(1);} 50%{ transform: rotateY(180deg) scale(1.02);} 100%{ transform: rotateY(360deg) scale(1);} }
@keyframes fxPulse{ 0%{ transform: scale(1); } 50%{ transform: scale(1.06);} 100%{ transform: scale(1);} }
@keyframes fxSpin{ from{ transform: rotate(0deg);} to{ transform: rotate(360deg);} }
@keyframes fxType{ 0%{ transform: scale(1);} 100%{ transform: scale(1.06);} }
@keyframes fxBurst{ 0%,100%{ transform: scale(1);} 50%{ transform: scale(1.12);} }
@keyframes fxStamp{ 0%{ transform: scale(.88);} 55%{ transform: scale(1.08);} 100%{ transform: scale(1);} }
@keyframes fxSpark{ 0%{ transform: scale(1);} 50%{ transform: scale(1.06) rotate(8deg);} 100%{ transform: scale(1);} }
@keyframes fxRoll{ 0%{ transform: rotate(0deg) scale(1);} 40%{ transform: rotate(110deg) scale(1.05);} 100%{ transform: rotate(240deg) scale(1);} }
@keyframes fxGlitch{ 0%{ transform: translate(0,0) scale(1);} 20%{ transform: translate(-2px,1px) scale(1.02);} 40%{ transform: translate(2px,-1px) scale(1.01);} 60%{ transform: translate(-1px,-2px) scale(1.02);} 80%{ transform: translate(1px,2px) scale(1.01);} 100%{ transform: translate(0,0) scale(1);} }

/* Gacha layout */
.gachaGrid{
  display:grid;
  grid-template-columns: repeat(5, minmax(0, 1fr));
  gap: 10px;
  margin: 6px 0 14px;
}
.gachaCard{
  position: relative;
  border-radius: 14px;
  height: 86px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  overflow:hidden;
  box-shadow: 0 10px 25px rgba(0,0,0,.25);
}
.gachaR{
  position:absolute; left:10px; top:10px;
  font-weight:900; letter-spacing:.5px;
}
.gachaIdx{
  position:absolute; right:10px; bottom:10px;
  font-size:12px; opacity:.7;
}
.gachaGlow{
  position:absolute; inset:-20px;
  background: radial-gradient(circle at 40% 30%, rgba(255,255,255,.22), rgba(255,255,255,.0) 60%);
  opacity:.65;
  transform: translateZ(0);
}
.gachaCard.r-N .gachaGlow{ opacity:.35; }
.gachaCard.r-R .gachaGlow{ opacity:.55; }
.gachaCard.r-SR .gachaGlow{ opacity:.75; }
.gachaCard.r-SSR .gachaGlow{ opacity:.95; }

.gachaOracle{
  margin-top: 6px;
  padding: 12px 12px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.05);
}
.gachaOracleTitle{ font-weight:900; margin-bottom:6px; opacity:.9;}
.gachaOracleText{ line-height:1.55; opacity:.92; }

/* === Enhanced colorful, more readable reveal FX (v8) === */
.revealFx{
  --c1: rgba(120,180,255,.95);
  --c2: rgba(255,130,200,.9);
  --c3: rgba(120,255,210,.85);
}
.revealFx .fxRing, .revealFx .fxSpark, .revealFx .fxRune{ position:absolute; inset:0; pointer-events:none; }

@keyframes ringPop {0%{transform:scale(.7);opacity:0} 35%{opacity:1} 100%{transform:scale(1.15);opacity:0}}
@keyframes runeDrift {0%{transform:translateY(10px);opacity:0} 30%{opacity:1} 100%{transform:translateY(-18px);opacity:0}}
@keyframes sparkFly {0%{transform:translate(0,0) scale(.8);opacity:0} 25%{opacity:1} 100%{transform:translate(var(--dx),var(--dy)) scale(1.1);opacity:0}}

.revealFx:after{
  content:"";
  position:absolute; inset:-2px;
  border-radius:18px;
  background:
    radial-gradient(220px 120px at 20% 0%, rgba(255,255,255,.10), transparent 60%),
    radial-gradient(220px 120px at 80% 100%, rgba(255,255,255,.08), transparent 60%);
  mix-blend-mode:screen;
  opacity:.85;
  pointer-events:none;
}

/* LOT:筒+籤更像抽出 */
.reveal-lot .revealFx{ 
  background:
    radial-gradient(240px 120px at 50% 30%, rgba(255,210,120,.18), transparent 60%),
    linear-gradient(180deg, rgba(20,26,44,.65), rgba(10,12,18,.55));
}
.reveal-lot .revealFx .fxRing:before{
  content:""; position:absolute; left:50%; top:50%;
  width:260px; height:260px; margin:-130px 0 0 -130px;
  border-radius:999px;
  background: radial-gradient(circle, rgba(255,180,90,.18), transparent 60%);
  box-shadow: 0 0 0 1px rgba(255,190,120,.20) inset, 0 0 28px rgba(255,170,90,.18);
  animation:ringPop .95s ease-out infinite;
}

/* DOORS:門縫透光 */
.reveal-doors .revealFx{
  background:
    linear-gradient(180deg, rgba(16,20,34,.70), rgba(10,12,18,.55)),
    radial-gradient(220px 140px at 50% 10%, rgba(140,190,255,.16), transparent 60%);
}
.reveal-doors .revealFx .fxRune:before{
  content:""; position:absolute; left:18px; right:18px; top:18px; bottom:18px;
  border-radius:16px;
  background: repeating-linear-gradient(135deg, rgba(140,190,255,.08) 0 10px, rgba(255,140,210,.06) 10px 20px);
  opacity:.55;
  filter: blur(.2px);
}

/* TAROT:牌面符印光 */
.reveal-tarot .revealFx{
  background:
    radial-gradient(240px 140px at 50% 20%, rgba(170,120,255,.16), transparent 60%),
    linear-gradient(180deg, rgba(18,16,34,.72), rgba(10,12,18,.55));
}
.reveal-tarot .revealFx .fxRing:before{
  content:""; position:absolute; left:50%; top:46%;
  width:240px; height:240px; margin:-120px 0 0 -120px;
  border-radius:999px;
  background:
    conic-gradient(from 0deg, rgba(170,120,255,.0), rgba(170,120,255,.18), rgba(255,150,210,.14), rgba(120,210,255,.10), rgba(170,120,255,.0));
  box-shadow: 0 0 0 1px rgba(200,160,255,.22) inset;
  animation:ringPop 1.1s ease-out infinite;
}

/* ORB:霧彩+星屑 */
.reveal-orb .revealFx{
  background:
    radial-gradient(260px 160px at 50% 35%, rgba(120,210,255,.16), transparent 60%),
    radial-gradient(220px 140px at 30% 20%, rgba(255,140,210,.12), transparent 65%),
    linear-gradient(180deg, rgba(14,18,32,.72), rgba(10,12,18,.55));
}
.reveal-orb .revealFx .fxSpark:before{
  content:""; position:absolute; inset:0;
  background:
    radial-gradient(2px 2px at 20% 40%, rgba(255,255,255,.7), transparent 60%),
    radial-gradient(2px 2px at 55% 30%, rgba(255,255,255,.55), transparent 60%),
    radial-gradient(2px 2px at 72% 58%, rgba(255,255,255,.65), transparent 60%),
    radial-gradient(2px 2px at 38% 70%, rgba(255,255,255,.5), transparent 60%);
  opacity:.8;
  animation:runeDrift 1.35s ease-out infinite;
}

/* WHEEL:指針亮+停格波紋 */
.reveal-wheel .revealFx{
  background:
    radial-gradient(260px 160px at 50% 35%, rgba(255,210,120,.14), transparent 60%),
    radial-gradient(220px 140px at 15% 70%, rgba(120,255,210,.12), transparent 65%),
    linear-gradient(180deg, rgba(16,22,34,.70), rgba(10,12,18,.55));
}
.reveal-wheel .revealFx .fxRing:before{
  content:""; position:absolute; left:50%; top:50%;
  width:280px; height:280px; margin:-140px 0 0 -140px;
  border-radius:999px;
  background: radial-gradient(circle, rgba(255,210,120,.14), transparent 62%);
  box-shadow: 0 0 0 1px rgba(255,220,150,.18) inset;
  animation:ringPop .9s ease-out infinite;
}

/* DICE:點數火花 */
.reveal-dice .revealFx{
  background:
    radial-gradient(240px 140px at 50% 35%, rgba(120,255,210,.14), transparent 60%),
    radial-gradient(200px 120px at 70% 20%, rgba(140,190,255,.12), transparent 65%),
    linear-gradient(180deg, rgba(14,20,30,.72), rgba(10,12,18,.55));
}
.reveal-dice .revealFx .fxSpark:before{
  content:""; position:absolute; left:50%; top:50%;
  width:6px; height:6px; margin:-3px;
  border-radius:99px;
  background: rgba(255,255,255,.9);
  box-shadow:
    -70px -20px 0 rgba(120,255,210,.65),
    60px -30px 0 rgba(140,190,255,.55),
    -35px 55px 0 rgba(255,170,90,.55),
    40px 60px 0 rgba(255,140,210,.45);
  opacity:.8;
  animation:runeDrift 1.05s ease-out infinite;
}

/* GACHA:稀有度色彩更明顯 + 幸運值 */
.gachaCard{ position:relative; overflow:hidden; }
.gachaCard:before{
  content:""; position:absolute; inset:-40px;
  background: radial-gradient(220px 120px at 30% 30%, rgba(255,255,255,.22), transparent 60%);
  transform: rotate(12deg);
  opacity:.65;
}
.gachaCard.r-N{ box-shadow: 0 0 0 1px rgba(255,255,255,.08) inset, 0 10px 24px rgba(0,0,0,.35); }
.gachaCard.r-R{ box-shadow: 0 0 0 1px rgba(120,210,255,.18) inset, 0 10px 24px rgba(0,0,0,.35); }
.gachaCard.r-SR{ box-shadow: 0 0 0 1px rgba(170,120,255,.20) inset, 0 10px 24px rgba(0,0,0,.35); }
.gachaCard.r-SSR{ box-shadow: 0 0 0 1px rgba(255,210,120,.22) inset, 0 10px 24px rgba(0,0,0,.35); }
.gachaCard.r-SSR .gachaGlow{ opacity:1; filter: blur(10px); }
.gachaLuck{
  margin: 10px 2px 0;
  padding: 10px 12px;
  border-radius: 14px;
  background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
  border: 1px solid rgba(255,255,255,.08);
  color: rgba(255,255,255,.92);
  display:flex; align-items:center; justify-content:center;
  gap:10px;
}
.gachaLuck .mono{ font-weight:800; letter-spacing:.5px; }

/* === Widget art upgrade (v9) === */
.revealWidget .glow{
  background:
    radial-gradient(circle at 50% 55%, rgba(255,255,255,.16), rgba(255,255,255,0) 62%),
    radial-gradient(circle at 30% 35%, rgba(120,210,255,.14), rgba(255,255,255,0) 60%),
    radial-gradient(circle at 70% 70%, rgba(255,140,210,.10), rgba(255,255,255,0) 60%);
}

/* LOT: bamboo-ish tube + red seal */
.rw-lot .tube{
  background:
    linear-gradient(180deg, rgba(255,220,150,.18), rgba(255,255,255,.03)),
    repeating-linear-gradient(90deg, rgba(255,210,120,.08) 0 6px, rgba(0,0,0,0) 6px 12px);
  box-shadow: 0 0 0 1px rgba(255,210,120,.16) inset, 0 18px 34px rgba(0,0,0,.42);
}
.rw-lot .slip:after{
  content:""; position:absolute; left:50%; top:10px; width:18px; height:18px; margin-left:-9px;
  border-radius:6px;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.28), rgba(255,60,90,.35));
  box-shadow: 0 0 0 1px rgba(255,90,120,.25) inset;
  opacity:.9;
}

/* DOORS: warm wood + cyan light gap */
.rw-doors .door{
  background:
    linear-gradient(180deg, rgba(255,190,120,.10), rgba(255,255,255,.03)),
    repeating-linear-gradient(90deg, rgba(255,190,120,.07) 0 7px, rgba(0,0,0,0) 7px 14px);
  box-shadow: 0 0 0 1px rgba(255,190,120,.14) inset, 0 20px 34px rgba(0,0,0,.42);
}
.rw-doors .door:before{
  content:""; position:absolute; right:12px; top:46px; width:10px; height:10px; border-radius:99px;
  background: radial-gradient(circle at 35% 35%, rgba(255,255,255,.40), rgba(255,210,120,.45));
  box-shadow: 0 0 16px rgba(255,210,120,.18);
}
.rw-doors .gap{
  position:absolute; left:50%; top:18px; bottom:10px; width:8px; margin-left:-4px;
  background: radial-gradient(10px 120px at 50% 50%, rgba(120,210,255,.42), rgba(120,210,255,0));
  filter: blur(.2px);
  opacity:.9;
}

/* TAROT: ornate border + purple rune */
.rw-tarot .card{
  background:
    linear-gradient(180deg, rgba(200,160,255,.16), rgba(255,255,255,.04)),
    radial-gradient(160px 90px at 50% 30%, rgba(255,255,255,.10), rgba(0,0,0,0) 60%);
  box-shadow: 0 0 0 1px rgba(200,160,255,.18) inset, 0 18px 34px rgba(0,0,0,.44);
}
.rw-tarot .card:before{
  content:""; position:absolute; inset:10px; border-radius:10px;
  box-shadow: 0 0 0 1px rgba(255,255,255,.12) inset;
  background:
    repeating-linear-gradient(135deg, rgba(255,255,255,.06) 0 8px, rgba(0,0,0,0) 8px 16px);
  opacity:.55;
}
.rw-tarot .card:after{
  content:""; position:absolute; left:50%; top:50%; width:34px; height:34px; margin:-17px;
  border-radius:999px;
  background: conic-gradient(from 0deg, rgba(170,120,255,.0), rgba(170,120,255,.35), rgba(255,140,210,.22), rgba(120,210,255,.18), rgba(170,120,255,.0));
  box-shadow: 0 0 18px rgba(170,120,255,.18);
  opacity:.85;
}

/* ORB: colored mist + tiny stars */
.rw-orb .sphere{
  background:
    radial-gradient(circle at 35% 30%, rgba(255,255,255,.22), rgba(255,255,255,0) 55%),
    radial-gradient(circle at 55% 70%, rgba(120,210,255,.20), rgba(255,255,255,0) 60%),
    radial-gradient(circle at 70% 35%, rgba(255,140,210,.14), rgba(255,255,255,0) 58%),
    linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
  box-shadow: 0 0 0 1px rgba(120,210,255,.14) inset, 0 22px 44px rgba(0,0,0,.50);
}
.rw-orb .mist:after{
  content:""; position:absolute; inset:0;
  background:
    radial-gradient(2px 2px at 22% 52%, rgba(255,255,255,.75), rgba(0,0,0,0)),
    radial-gradient(2px 2px at 62% 38%, rgba(255,255,255,.55), rgba(0,0,0,0)),
    radial-gradient(2px 2px at 74% 62%, rgba(255,255,255,.65), rgba(0,0,0,0));
  opacity:.8;
}

/* WHEEL: colored segments */
.rw-wheel .wheel{
  background:
    conic-gradient(from 0deg,
      rgba(255,210,120,.20) 0 18%,
      rgba(120,210,255,.18) 18% 36%,
      rgba(255,140,210,.16) 36% 54%,
      rgba(120,255,210,.16) 54% 72%,
      rgba(200,160,255,.16) 72% 90%,
      rgba(255,210,120,.20) 90% 100%);
  box-shadow: 0 0 0 1px rgba(255,255,255,.12) inset, 0 22px 44px rgba(0,0,0,.48);
}
.rw-wheel .hub{
  background: radial-gradient(circle at 35% 35%, rgba(255,255,255,.20), rgba(255,255,255,.05));
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset;
}

/* DICE: stronger 3D + pips contrast */
.rw-dice .cube{
  background:
    linear-gradient(180deg, rgba(120,255,210,.14), rgba(255,255,255,.04));
  box-shadow: 0 0 0 1px rgba(120,255,210,.18) inset, 0 22px 44px rgba(0,0,0,.48);
}
.rw-dice .pip{ background: rgba(255,255,255,.85); box-shadow: 0 0 10px rgba(120,255,210,.18); }

/* GACHA: rarity label only, no index */
.gachaIdx{ display:none !important; }
.gachaR{
  font-weight:900;
  letter-spacing:.8px;
  text-shadow: 0 6px 16px rgba(0,0,0,.55);
}

/* === Ultra visual upgrade pack (v10) === */

/* General: richer contrast + subtle vignette for widget stage */
.revealLayer{
  background:
    radial-gradient(520px 260px at 50% 20%, rgba(255,255,255,.06), rgba(0,0,0,0) 60%),
    radial-gradient(620px 320px at 50% 120%, rgba(0,0,0,.55), rgba(0,0,0,0) 60%);
}
.revealWidget{
  transform: translateZ(0);
}
.revealWidget:before{
  content:"";
  position:absolute; inset:-10px;
  border-radius: 24px;
  background: radial-gradient(340px 180px at 50% 15%, rgba(255,255,255,.08), rgba(0,0,0,0) 60%);
  pointer-events:none;
}

/* LOT: add cap + engraving lines */
.rw-lot .tube:before{
  content:"";
  position:absolute; left:10px; right:10px; top:-8px; height:18px;
  border-radius: 14px 14px 10px 10px;
  background: linear-gradient(180deg, rgba(255,210,120,.22), rgba(255,255,255,.04));
  box-shadow: 0 0 0 1px rgba(255,210,120,.14) inset;
}
.rw-lot .tube:after{
  content:"";
  position:absolute; left:18px; right:18px; top:26px; bottom:18px;
  border-radius: 14px;
  background: repeating-linear-gradient(180deg, rgba(0,0,0,0) 0 14px, rgba(255,255,255,.03) 14px 15px);
  opacity:.55;
}

/* DOORS: add panels + hinges + center gap glow (uses .gap injected via CSS) */
.rw-doors .door:after{
  content:"";
  position:absolute; inset:12px;
  border-radius: 14px;
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset;
  background: linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,.18));
  opacity:.6;
}
.rw-doors .wrap:before{
  content:"";
  position:absolute; left:50%; top:14px; bottom:14px; width:10px; margin-left:-5px;
  border-radius: 10px;
  background: radial-gradient(10px 160px at 50% 50%, rgba(120,210,255,.46), rgba(120,210,255,0));
  opacity:.85;
  pointer-events:none;
}

/* TAROT: corner ornaments */
.rw-tarot .card .corner{
  position:absolute; width:14px; height:14px;
  border: 2px solid rgba(255,255,255,.18);
  border-radius: 6px;
  opacity:.6;
}
.rw-tarot .card .c1{ left:10px; top:10px; border-right:none; border-bottom:none; }
.rw-tarot .card .c2{ right:10px; top:10px; border-left:none; border-bottom:none; }
.rw-tarot .card .c3{ left:10px; bottom:10px; border-right:none; border-top:none; }
.rw-tarot .card .c4{ right:10px; bottom:10px; border-left:none; border-top:none; }

/* ORB: add stand ring + base */
.rw-orb .stand{
  position:absolute; left:50%; top:74%; width:160px; height:38px; margin-left:-80px;
  border-radius: 999px;
  background: linear-gradient(180deg, rgba(255,210,120,.18), rgba(255,255,255,.04));
  box-shadow: 0 0 0 1px rgba(255,210,120,.12) inset, 0 18px 40px rgba(0,0,0,.50);
  opacity:.95;
}
.rw-orb .stand:before{
  content:""; position:absolute; inset:6px 14px;
  border-radius: 999px;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.16), rgba(0,0,0,0) 60%);
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset;
}

/* WHEEL: add tick marks */
.rw-wheel .wheel:after{
  content:"";
  position:absolute; inset:12px;
  border-radius: 999px;
  background: repeating-conic-gradient(from 0deg, rgba(255,255,255,.14) 0 2deg, rgba(0,0,0,0) 2deg 12deg);
  opacity:.35;
}

/* DICE: bevel edges */
.rw-dice .cube:before{
  content:"";
  position:absolute; inset:8px;
  border-radius: 18px;
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset;
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,0));
  opacity:.75;
}

/* RITUAL: rune ring with conic gradient */
.rw-ritual .ring{
  background:
    conic-gradient(from 0deg,
      rgba(255,140,210,.20),
      rgba(120,210,255,.18),
      rgba(120,255,210,.16),
      rgba(255,210,120,.18),
      rgba(200,160,255,.18),
      rgba(255,140,210,.20));
  box-shadow: 0 0 0 1px rgba(255,255,255,.12) inset, 0 22px 44px rgba(0,0,0,.48);
}
.rw-ritual .ring:after{
  content:"";
  position:absolute; inset:14px;
  border-radius: 999px;
  background: repeating-conic-gradient(from 0deg, rgba(255,255,255,.14) 0 8deg, rgba(0,0,0,0) 8deg 16deg);
  opacity:.35;
}

/* REVERSE: ink cracks */
.rw-reverse .ink:after{
  content:"";
  position:absolute; inset:0;
  background:
    radial-gradient(120px 80px at 30% 40%, rgba(255,60,90,.08), rgba(0,0,0,0) 70%),
    radial-gradient(120px 80px at 70% 55%, rgba(120,210,255,.06), rgba(0,0,0,0) 72%),
    repeating-linear-gradient(135deg, rgba(255,255,255,.06) 0 2px, rgba(0,0,0,0) 2px 14px);
  opacity:.18;
}

/* === Gacha card face (v10) === */
@keyframes holoSweep {0%{transform:translateX(-60%) rotate(12deg); opacity:.0}
  22%{opacity:.55} 55%{opacity:.35}
  100%{transform:translateX(60%) rotate(12deg); opacity:0}}
@keyframes emblemPulse {0%,100%{transform:scale(.96); opacity:.65} 50%{transform:scale(1.05); opacity:.9}}

.gachaCard{
  border-radius: 18px;
}
.gachaFrame{
  position:absolute; inset:8px;
  border-radius: 14px;
  box-shadow: 0 0 0 1px rgba(255,255,255,.14) inset;
  background:
    radial-gradient(240px 160px at 50% 20%, rgba(255,255,255,.10), rgba(0,0,0,0) 60%),
    repeating-linear-gradient(135deg, rgba(255,255,255,.06) 0 10px, rgba(0,0,0,0) 10px 20px);
  opacity:.75;
}
.gachaPattern{
  position:absolute; inset:18px;
  border-radius: 12px;
  background:
    radial-gradient(120px 80px at 25% 25%, rgba(255,255,255,.10), rgba(0,0,0,0) 70%),
    radial-gradient(140px 90px at 70% 70%, rgba(255,255,255,.08), rgba(0,0,0,0) 70%),
    repeating-conic-gradient(from 0deg, rgba(255,255,255,.06) 0 6deg, rgba(0,0,0,0) 6deg 14deg);
  opacity:.45;
}
.gachaHolo{
  position:absolute; inset:-40px;
  background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,.22), rgba(255,255,255,0));
  transform: translateX(-60%) rotate(12deg);
  mix-blend-mode: screen;
  animation: holoSweep 1.35s ease-in-out infinite;
  opacity:.0;
}
.gachaEmblem{
  position:absolute; left:50%; top:50%;
  width:56px; height:56px; margin:-28px;
  border-radius: 999px;
  background:
    conic-gradient(from 0deg, rgba(255,255,255,0), rgba(255,255,255,.20), rgba(255,255,255,0)),
    radial-gradient(circle at 35% 35%, rgba(255,255,255,.16), rgba(0,0,0,0) 60%);
  box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset;
  animation: emblemPulse 1.4s ease-in-out infinite;
  opacity:.75;
}
.gachaCard .gachaR{
  position:absolute; left:12px; top:12px;
  padding: 6px 10px;
  border-radius: 999px;
  background: rgba(0,0,0,.28);
  border: 1px solid rgba(255,255,255,.10);
  backdrop-filter: blur(6px);
}
.gachaCard.r-N{ background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03)); }
.gachaCard.r-R{ background: linear-gradient(180deg, rgba(120,210,255,.10), rgba(255,255,255,.03)); }
.gachaCard.r-SR{ background: linear-gradient(180deg, rgba(200,160,255,.12), rgba(255,255,255,.03)); }
.gachaCard.r-SSR{ background: linear-gradient(180deg, rgba(255,210,120,.14), rgba(255,255,255,.03)); }
.gachaCard.r-SSR .gachaHolo{ opacity:.55; }
.gachaCard.r-SSR .gachaEmblem{
  background:
    conic-gradient(from 0deg, rgba(255,210,120,0), rgba(255,210,120,.35), rgba(255,140,210,.22), rgba(120,210,255,.18), rgba(255,210,120,0)),
    radial-gradient(circle at 35% 35%, rgba(255,255,255,.18), rgba(0,0,0,0) 60%);
  box-shadow: 0 0 0 1px rgba(255,220,150,.20) inset, 0 0 20px rgba(255,210,120,.14);
}

/* === Visual upgrade: lot becomes a real-ish 籤筒 (v11) === */
.rw-lot{ filter: drop-shadow(0 18px 38px rgba(0,0,0,.55)); }
.rw-lot .cap{
  left:72px; top:-2px; width:76px; height:22px;
  background:
    radial-gradient(circle at 35% 35%, rgba(255,255,255,.18), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, rgba(255,210,120,.16), rgba(255,255,255,.04));
  box-shadow: 0 0 0 1px rgba(255,210,120,.14) inset, 0 10px 18px rgba(0,0,0,.35);
}
.rw-lot .cap:after{
  content:""; position:absolute; left:10px; right:10px; top:6px; height:6px;
  border-radius: 999px;
  background: linear-gradient(90deg, rgba(255,255,255,.10), rgba(255,255,255,.02));
  opacity:.75;
}
.rw-lot .tube{
  left:80px; top:10px; width:60px; height:122px; border-radius:24px;
  background:
    linear-gradient(180deg, rgba(255,220,150,.16), rgba(255,255,255,.03)),
    repeating-linear-gradient(90deg, rgba(255,210,120,.10) 0 7px, rgba(0,0,0,0) 7px 14px);
  box-shadow: 0 0 0 1px rgba(255,210,120,.16) inset, 0 18px 34px rgba(0,0,0,.46);
  overflow:hidden;
}
.rw-lot .bambooNodes{
  position:absolute; inset:0;
  background:
    radial-gradient(120px 18px at 50% 26px, rgba(0,0,0,.18), rgba(0,0,0,0) 70%),
    radial-gradient(120px 18px at 50% 74px, rgba(0,0,0,.16), rgba(0,0,0,0) 70%),
    radial-gradient(120px 18px at 50% 104px, rgba(0,0,0,.14), rgba(0,0,0,0) 70%);
  opacity:.55;
}
.rw-lot .bambooGrain{
  position:absolute; inset:0;
  background:
    radial-gradient(220px 120px at 30% 20%, rgba(255,255,255,.10), rgba(0,0,0,0) 60%),
    radial-gradient(240px 120px at 70% 80%, rgba(0,0,0,.12), rgba(0,0,0,0) 65%),
    repeating-linear-gradient(180deg, rgba(255,255,255,.04) 0 13px, rgba(0,0,0,0) 13px 26px);
  opacity:.7;
  mix-blend-mode: screen;
}
.rw-lot .tube:before{
  content:""; position:absolute; left:10px; right:10px; top:8px; height:10px;
  border-radius: 999px;
  background: radial-gradient(80px 18px at 50% 50%, rgba(0,0,0,.32), rgba(0,0,0,0) 72%);
  opacity:.55; /* mouth opening */
}
.rw-lot .tube:after{
  content:""; position:absolute; inset:0;
  box-shadow: 0 -10px 18px rgba(0,0,0,.18) inset, 0 10px 18px rgba(255,255,255,.05) inset;
  border-radius: 24px;
  opacity:.9;
}
.rw-lot .slips{ position:absolute; left:0; top:0; right:0; bottom:0; }
.rw-lot .slip{
  left:98px; width:30px; height:84px; border-radius:12px;
  background:
    linear-gradient(180deg, rgba(255,255,255,.22), rgba(255,255,255,.06)),
    repeating-linear-gradient(180deg, rgba(0,0,0,0) 0 10px, rgba(0,0,0,.06) 10px 11px);
  box-shadow: 0 0 0 1px rgba(255,255,255,.12) inset, 0 14px 24px rgba(0,0,0,.30);
  transform-origin: 50% 10%;
}
.rw-lot .slip:before{
  content:""; position:absolute; left:7px; right:7px; top:16px; height:48px;
  border-radius: 10px;
  background: repeating-linear-gradient(180deg, rgba(0,0,0,.12) 0 2px, rgba(0,0,0,0) 2px 7px);
  opacity:.45; /* calligraphy strokes */
}
.rw-lot .slip:after{
  content:""; position:absolute; left:50%; top:10px; width:18px; height:18px; margin-left:-9px;
  border-radius:6px;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.26), rgba(255,60,90,.40));
  box-shadow: 0 0 0 1px rgba(255,90,120,.25) inset, 0 10px 18px rgba(255,60,90,.10);
  opacity:.95; /* red seal */
}
.rw-lot .slip.s2{ top:50px; opacity:.55; transform: rotate(-3deg) translateY(10px) scale(.98); }
.rw-lot .slip.s3{ top:54px; opacity:.40; transform: rotate(2deg) translateY(14px) scale(.96); }
.rw-lot .slip.s1{ top:42px; opacity:1; }
.rw-lot .slip{ animation:none; }
.rw-lot .slip.s1{ animation: lotSlip 0.75s ease-in-out infinite; }

/* slightly richer doors / tarot / wheel art (small boost, keeps v10) */
.rw-doors .door{
  background:
    linear-gradient(180deg, rgba(255,190,120,.12), rgba(255,255,255,.03)),
    repeating-linear-gradient(90deg, rgba(255,190,120,.08) 0 6px, rgba(0,0,0,0) 6px 12px);
}
.rw-tarot .card{ background:
  linear-gradient(180deg, rgba(200,160,255,.18), rgba(255,255,255,.04)),
  radial-gradient(180px 110px at 50% 20%, rgba(255,255,255,.10), rgba(0,0,0,0) 60%); }
.rw-wheel .wheel{ filter: drop-shadow(0 18px 34px rgba(0,0,0,.45)); }

/* === Sheet responsiveness fix (v12) === */
.overlay{ align-items: center; }
.sheet{
  max-height: calc(100vh - 28px - env(safe-area-inset-bottom));
  display:flex;
  flex-direction:column;
}
.sheetTop{ flex-wrap:wrap; }
.sheetTop .meta{ white-space:normal; }
.sheetBody{
  overflow:auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}
.toggleRow{ flex-wrap:wrap; gap:10px; }
.toggleRow .lbl{ min-width: 220px; }
@media (max-width:420px){
  .overlay{ padding: 10px; padding-bottom: calc(10px + env(safe-area-inset-bottom)); }
  .sheet{ border-radius: 18px; }
  .sheetBody{ padding: 12px; }
  .resultTitle{ font-size: 15px; }
}
</style>
</head>
<body>
<div class="app safeTop safeBot">

  <header>
    <div class="topbar">
      <button class="iconbtn" id="btnBack" aria-label="返回" title="返回" style="display:none;">←</button>
      <div class="brand">
        <div class="t1" id="topTitle">運氣占卜（大全）</div>
        <div class="t2 mono" id="topSub">純單機 · 純娛樂 · 不連網</div>
      </div>
      <div class="spacer"></div>
      <button class="iconbtn" id="btnSettings" aria-label="設定" title="設定">⚙</button>
    </div>
  </header>

  <main id="viewHome">
    <div class="panel">
      <div class="panelHead">
        <div>
          <div class="h">想玩就玩，想抽就抽</div>
          <div class="sub">全部可玩；你可在設定切換「純隨機 / 每日固定」。不顯示幸運值、不算分數，純娛樂。</div>
        </div>
      </div>
      <div class="panelBody">
        <div class="row" style="margin-bottom:10px;">
          <span class="pill" id="pillMode">模式：純隨機</span>
          <span class="pill" id="pillVibe">震動：開</span>
          <span class="pill" id="pillNpc">NPC：嘴臭</span>
        </div>

        <div class="grid" id="gameGrid"></div>

        <div class="hr"></div>
        <div class="row">
          <button class="btn ghost" id="btnQuickRandom">隨便來一個</button>
          <button class="btn ghost" id="btnOpenHistory">看歷史紀錄</button>
          <button class="btn ghost" id="btnOpenFav">看收藏</button>
        </div>
      </div>
    </div>
  </main>

  <main id="viewHistory" style="display:none;">
    <div class="panel">
      <div class="panelHead">
        <div>
          <div class="h">歷史紀錄</div>
          <div class="sub">你剛剛抽過什麼，全部都在這。可單筆收藏、也可清空。</div>
        </div>
      </div>
      <div class="panelBody">
        <div class="row" style="margin-bottom:12px;">
          <button class="btn danger" id="btnClearHistory">清空歷史</button>
          <button class="btn ghost" id="btnExportHistory">匯出 JSON</button>
        </div>
        <div class="list" id="historyList"></div>
        <div class="hint" id="historyEmpty" style="display:none;color:var(--muted);">目前沒有紀錄。去抽幾次就有了。</div>
      </div>
    </div>
  </main>

  <main id="viewFav" style="display:none;">
    <div class="panel">
      <div class="panelHead">
        <div>
          <div class="h">收藏</div>
          <div class="sub">你覺得值得留著的結果。保存在此裝置。</div>
        </div>
      </div>
      <div class="panelBody">
        <div class="row" style="margin-bottom:12px;">
          <button class="btn danger" id="btnClearFav">清空收藏</button>
          <button class="btn ghost" id="btnExportFav">匯出 JSON</button>
        </div>
        <div class="list" id="favList"></div>
        <div class="hint" id="favEmpty" style="display:none;color:var(--muted);">目前沒有收藏。去抽結果後點「收藏」即可。</div>
      </div>
    </div>
  </main>

  <div class="bottomNav">
    <div class="bar">
      <div class="tab active" id="tabHome">遊戲</div>
      <div class="tab" id="tabHistory">歷史</div>
      <div class="tab" id="tabFav">收藏</div>
    </div>
  </div>

  <div class="overlay" id="overlay">
    <div class="sheet" role="dialog" aria-modal="true" aria-label="內容面板">
      <div class="sheetTop">
        <div class="title" id="sheetTitle">結果</div>
        <div class="meta mono" id="sheetMeta"></div>
        <button class="iconbtn" id="btnCloseSheet" aria-label="關閉" title="關閉">✕</button>
      </div>
      <div class="sheetBody" id="sheetBody"></div>
    </div>
  </div>

  <div class="toast" id="toast"></div>
</div>

<script>
(() => {
  "use strict";

  /* ===========================
     Storage keys
  ============================ */
  const LS_KEY = "luck_oracle_offline_full_v1";
  const LS = {
    load(){
      try{
        const raw = localStorage.getItem(LS_KEY);
        if(!raw) return null;
        return JSON.parse(raw);
      }catch(e){ return null; }
    },
    save(obj){
      localStorage.setItem(LS_KEY, JSON.stringify(obj));
    }
  };

  /* ===========================
     State
  ============================ */
  const state = {
    mode: "random",     // "random" | "daily"
    tone: "mix",       // "A" | "B" | "C" | "mix"
    vibrate: true,
    npcMode: "spicy",   // "spicy" | "soft"
    reverseStage: 1,   // 1..3 (反向占卜遞進)
    history: [],
    fav: [],
    stats: { plays: {}, reverseCount: 0 }, // achievements / counters (no luck values)
  };

  const now = () => new Date();
  const pad2 = n => String(n).padStart(2,"0");
  const fmtTime = (d) => {
    const dt = (d instanceof Date) ? d : new Date(d);
    if (isNaN(dt.getTime())) return "--:--";
    return `${pad2(dt.getHours())}:${pad2(dt.getMinutes())}`;
  };
  const fmtDate = (d) => {
    const dt = (d instanceof Date) ? d : new Date(d);
    if (isNaN(dt.getTime())) return "----/--/--";
    return `${dt.getFullYear()}-${pad2(dt.getMonth()+1)}-${pad2(dt.getDate())}`;
  };
  const todayKey = () => {
    const d = now();
    return `${d.getFullYear()}${pad2(d.getMonth()+1)}${pad2(d.getDate())}`;
  };

  /* ===========================
     RNG: random or daily seeded
  ============================ */
  function xmur3(str){
    let h = 1779033703 ^ str.length;
    for (let i = 0; i < str.length; i++){
      h = Math.imul(h ^ str.charCodeAt(i), 3432918353);
      h = (h << 13) | (h >>> 19);
    }
    return function(){
      h = Math.imul(h ^ (h >>> 16), 2246822507);
      h = Math.imul(h ^ (h >>> 13), 3266489909);
      h ^= h >>> 16;
      return h >>> 0;
    };
  }
  function mulberry32(a){
    return function(){
      let t = a += 0x6D2B79F5;
      t = Math.imul(t ^ (t >>> 15), t | 1);
      t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
      return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
    };
  }
  function getRng(scope){
    if(state.mode === "random"){
      return Math.random;
    }
    const salt = getDeviceSalt();
    const seedStr = `${todayKey()}|${scope}|${salt}`;
    const seed = xmur3(seedStr)();
    return mulberry32(seed);
  }
  function getDeviceSalt(){
    const k = "luck_oracle_device_salt_full";
    let v = localStorage.getItem(k);
    if(!v){
      v = `${Math.random().toString(16).slice(2)}${Date.now().toString(16)}`;
      localStorage.setItem(k, v);
    }
    return v;
  }

  /* ===========================
     UI helpers
  ============================ */
  const $ = sel => document.querySelector(sel);
  const elGrid = $("#gameGrid");
  const overlay = $("#overlay");
  const sheetTitle = $("#sheetTitle");
  const sheetMeta = $("#sheetMeta");
  const sheetBody = $("#sheetBody");
  const toast = $("#toast");

  function showToast(msg){
    toast.textContent = msg;
    toast.classList.add("show");
    setTimeout(() => toast.classList.remove("show"), 1400);
  }
  function haptic(ms=18){
    if(!state.vibrate) return;
    if(navigator.vibrate) navigator.vibrate(ms);
  }
  function openSheet(title, meta, bodyHtml){
    sheetTitle.textContent = title;
    sheetMeta.textContent = meta || "";
    sheetBody.innerHTML = bodyHtml;
    overlay.classList.add("show");
  }
  function closeSheet(){ overlay.classList.remove("show"); }
  function setTop(title, sub){
    $("#topTitle").textContent = title;
    $("#topSub").textContent = sub;
  }

  /* ===========================
     Views
  ============================ */
  const views = {
    home: $("#viewHome"),
    history: $("#viewHistory"),
    fav: $("#viewFav"),
  };
  function showView(name){
    Object.keys(views).forEach(k => views[k].style.display = (k===name) ? "" : "none");
    $("#tabHome").classList.toggle("active", name==="home");
    $("#tabHistory").classList.toggle("active", name==="history");
    $("#tabFav").classList.toggle("active", name==="fav");

    if(name==="home"){
      setTop("運氣占卜（大全）", "純單機 · 純娛樂 · 不連網");
      $("#btnBack").style.display = "none";
    }else if(name==="history"){
      setTop("歷史紀錄", "可收藏單筆 · 可匯出 · 可清空");
      $("#btnBack").style.display = "";
    }else if(name==="fav"){
      setTop("收藏", "保留你覺得值得的結果");
      $("#btnBack").style.display = "";
    }
  }

  /* ===========================
     Content libraries (no luck values)
  ============================ */
  // ========================================
//  Phrase packs (A/B/C) embedded (v2)
//  A: 嘴臭直白  B: 中性理性  C: 占卜玄學
// ========================================
const PHRASES = {"meta": {"version": "v1", "notes": "A=嘴臭/直接，B=中性理性，C=占卜感，D=系統提示"}, "games": {"lot": {"name": "籤筒抽籤", "type": "normal", "tones": {"A": ["不用演，先去睡，不然你會被自己氣死（籤筒抽籤）", "聽好，閉嘴三秒，不然你會被人看破手腳", "講白了，把手機放下，不然你會一直原地打轉", "聽好，去把訊息回掉，不然你會更累", "聽好，閉嘴三秒，不然你會被自己氣死", "先別急著嘴硬，閉嘴三秒，不然你會更累（籤筒抽籤）", "講白了，去把訊息回掉，不然你會被自己氣死", "聽好，把拖延停掉，不然你又要後悔", "你醒醒，把拖延停掉，不然等著翻車", "我看你是，把拖延停掉，不然你會被自己氣死", "聽好，先去喝水，不然等著翻車（籤筒抽籤）", "你到底想怎樣，先去睡，不然明天你會哭", "先別急著嘴硬，先去睡，不然你會被人看破手腳", "講白了，把拖延停掉，不然明天你會哭", "你到底想怎樣，先去睡，不然你又要後悔", "我看你是，把拖延停掉，不然你會更累（籤筒抽籤）", "不用演，閉嘴三秒，不然你會被人看破手腳", "講白了，把拖延停掉，不然等著翻車", "我看你是，先去喝水，不然你會卡到發瘋", "你到底想怎樣，把爛習慣砍掉，不然事情只會更亂"], "B": ["籤筒抽籤／先完成最小一步，收尾優先，以穩定為先", "籤筒抽籤：先把干擾移除，確認優先，留有彈性", "籤筒抽籤：先把條件寫清楚，備份優先，把握窗口期", "籤筒抽籤：先完成最小一步，收尾優先，今天適合保守推進", "籤筒抽籤／先把干擾移除，規劃優先，注意疲勞影響判斷", "籤筒抽籤：先把時間排出來，備份優先，把握窗口期", "籤筒抽籤：先把資料補齊，執行優先，避免衝動決策", "籤筒抽籤：先把條件寫清楚，執行優先，以可持續為準", "籤筒抽籤／先把重點抓住，執行優先，不要同時開太多坑", "籤筒抽籤：先把條件寫清楚，確認優先，避免衝動決策", "籤筒抽籤：先把資料補齊，盤點優先，以可持續為準", "籤筒抽籤：先做低成本測試，停下來優先，以穩定為先", "籤筒抽籤／先把風險列出來，停下來優先，先做再迭代", "籤筒抽籤：先把順序排好，盤點優先，避免衝動決策", "籤筒抽籤：先把時間排出來，停下來優先，先做再迭代", "籤筒抽籤／先做低成本測試，備份優先，今天適合保守推進", "籤筒抽籤：先把順序排好，停下來優先，留有彈性", "籤筒抽籤：先把資料補齊，溝通優先，把握窗口期", "籤筒抽籤：先把風險列出來，溝通優先，把節奏抓回來", "籤筒抽籤／先把風險列出來，溝通優先，留有彈性"], "C": ["骰面低語：先修復再擴張，有貴人暗中推你一把（籤筒抽籤）", "門縫透亮：該結束的就結束；某個人會主動靠近（籤筒抽籤）", "線索浮現：與其求快不如求準；某個人會主動靠近（籤筒抽籤）", "星位轉動：先斷捨離再前進；你會收到明確確認（籤筒抽籤）", "星位轉動：先斷捨離再前進；今天的選擇會影響一週（籤筒抽籤）", "水面映照：答案在你忽略的細節；一個訊息會改變走向（籤筒抽籤）", "水面映照：今天以守為攻，阻礙會以另一種方式消失（籤筒抽籤）", "水面映照：該說清楚的就說清楚；一個訊息會改變走向（籤筒抽籤）", "輪盤停格：你正在累積力量；你會突然想通（籤筒抽籤）", "骰面低語：該結束的就結束；舊問題將被迫面對（籤筒抽籤）", "門縫透亮：先斷捨離再前進；今天的選擇會影響一週（籤筒抽籤）", "霧散：先斷捨離再前進，今天的選擇會影響一週（籤筒抽籤）", "星位轉動：直覺比你想得可靠；你會收到明確確認（籤筒抽籤）", "星位轉動：與其求快不如求準；舊問題將被迫面對（籤筒抽籤）", "骰面低語：答案在你忽略的細節；你會看見新的可能（籤筒抽籤）", "輪盤停格：該說清楚的就說清楚；今天的選擇會影響一週（籤筒抽籤）", "線索浮現：今天以守為攻；有貴人暗中推你一把（籤筒抽籤）", "輪盤停格：先退半步就會看見路，舊問題將被迫面對（籤筒抽籤）", "籤意落定：與其求快不如求準；有貴人暗中推你一把（籤筒抽籤）", "籤意落定：先退半步就會看見路；今天的選擇會影響一週（籤筒抽籤）"]}}, "doors": {"name": "命運三門", "type": "normal", "tones": {"A": ["先別急著嘴硬，先把錢收好，不然等著翻車（命運三門）", "別鬧，收手，不然你會被自己氣死", "別再自欺欺人，把拖延停掉，不然你會卡到發瘋", "聽好，閉嘴三秒，不然你會被自己氣死", "你到底想怎樣，把那件事做完，不然你會卡到發瘋", "你醒醒，閉嘴三秒，不然你會更累（命運三門）", "別鬧，先去睡，不然你會被人看破手腳", "講白了，把那件事做完，不然你又要後悔", "你到底想怎樣，收手，不然等著翻車", "別鬧，先去喝水，不然你會一直原地打轉", "聽好，先把錢收好，不然今天就白忙（命運三門）", "我說真的，去把訊息回掉，不然你會被自己氣死", "講白了，閉嘴三秒，不然你又要後悔", "我說真的，去把訊息回掉，不然你會一直原地打轉", "你醒醒，把爛習慣砍掉，不然明天你會哭", "你醒醒，把拖延停掉，不然等著翻車（命運三門）", "聽好，去把訊息回掉，不然明天你會哭", "別再自欺欺人，先把錢收好，不然事情只會更亂", "你醒醒，把那件事做完，不然你會被人看破手腳", "你醒醒，去把訊息回掉，不然你會更累"], "B": ["命運三門／先把資料補齊，盤點優先，不要同時開太多坑", "命運三門：先完成最小一步，調整優先，避免衝動決策", "命運三門：先完成最小一步，溝通優先，避免衝動決策", "命運三門：先把重點抓住，執行優先，把節奏抓回來", "命運三門／先把時間排出來，規劃優先，以可持續為準", "命運三門：先做低成本測試，執行優先，注意疲勞影響判斷", "命運三門：先完成最小一步，盤點優先，注意疲勞影響判斷", "命運三門：先把干擾移除，溝通優先，先做再迭代", "命運三門／先把資料補齊，執行優先，先做再迭代", "命運三門：先把干擾移除，收尾優先，留有彈性", "命運三門：先把風險列出來，規劃優先，注意疲勞影響判斷", "命運三門：先把風險列出來，規劃優先，避免衝動決策", "命運三門／先完成最小一步，執行優先，留有彈性", "命運三門：先把順序排好，備份優先，注意疲勞影響判斷", "命運三門：先把界線講明，收尾優先，避免衝動決策", "命運三門：先把時間排出來，調整優先，避免衝動決策", "命運三門／先把風險列出來，收尾優先，把節奏抓回來", "命運三門：先把重點抓住，執行優先，注意疲勞影響判斷", "命運三門：先把風險列出來，確認優先，把節奏抓回來", "命運三門：先把重點抓住，調整優先，今天適合保守推進"], "C": ["骰面低語：你正在累積力量，今天的選擇會影響一週（命運三門）", "門縫透亮：與其求快不如求準；你會突然想通（命運三門）", "牌面回應：該說清楚的就說清楚；阻礙會以另一種方式消失（命運三門）", "光線偏移：先修復再擴張；某個人會主動靠近（命運三門）", "骰面低語：今天以守為攻；有貴人暗中推你一把（命運三門）", "霧散：直覺比你想得可靠；你會在轉角遇到機會（命運三門）", "骰面低語：先退半步就會看見路，你會在轉角遇到機會（命運三門）", "線索浮現：先修復再擴張；一個訊息會改變走向（命運三門）", "骰面低語：該說清楚的就說清楚；舊問題將被迫面對（命運三門）", "星位轉動：今天以守為攻；你會看見新的可能（命運三門）", "門縫透亮：該結束的就結束；舊問題將被迫面對（命運三門）", "骰面低語：你正在累積力量；某個人會主動靠近（命運三門）", "霧散：答案在你忽略的細節，一個訊息會改變走向（命運三門）", "星位轉動：該結束的就結束；某個人會主動靠近（命運三門）", "星位轉動：答案在你忽略的細節；某個人會主動靠近（命運三門）", "門縫透亮：今天以守為攻；有貴人暗中推你一把（命運三門）", "星位轉動：直覺比你想得可靠；舊問題將被迫面對（命運三門）", "牌面回應：今天以守為攻；你會在轉角遇到機會（命運三門）", "水面映照：今天以守為攻，你會收到明確確認（命運三門）", "星位轉動：該結束的就結束；你會突然想通（命運三門）"]}}, "tarot": {"name": "單張塔羅", "type": "normal", "tones": {"A": ["我說真的，把拖延停掉，不然你會更累（單張塔羅）", "別鬧，把手機放下，不然你會卡到發瘋", "你醒醒，去把訊息回掉，不然你會更累", "我說真的，先把錢收好，不然你會一直原地打轉", "別鬧，先去睡，不然你會更累", "不用演，把拖延停掉，不然你會被人看破手腳（單張塔羅）", "不用演，先去睡，不然你會更累", "不用演，先去喝水，不然明天你會哭", "講白了，先去睡，不然你又要後悔", "你醒醒，把爛習慣砍掉，不然這波單張塔羅就白忙", "別鬧，先把錢收好，不然明天你會哭（單張塔羅）", "先別急著嘴硬，先把錢收好，不然你會更累", "講白了，閉嘴三秒，不然明天你會哭", "你醒醒，把爛習慣砍掉，不然你會卡到發瘋", "聽好，收手，不然你會被自己氣死", "先別急著嘴硬，先去喝水，不然你會被人看破手腳（單張塔羅）", "我說真的，把那件事做完，不然等著翻車", "別鬧，先把錢收好，不然你會一直原地打轉", "先別急著嘴硬，收手，不然你會更累", "先別急著嘴硬，把拖延停掉，不然你會一直原地打轉"], "B": ["單張塔羅／先把資料補齊，確認優先，留有彈性", "單張塔羅：先把資料補齊，調整優先，以穩定為先", "單張塔羅：先完成最小一步，溝通優先，避免衝動決策", "單張塔羅：先把時間排出來，盤點優先，把握窗口期", "單張塔羅／先把條件寫清楚，調整優先，注意疲勞影響判斷", "單張塔羅：先把風險列出來，確認優先，以可持續為準", "單張塔羅：先把資料補齊，確認優先，今天適合保守推進", "單張塔羅：先把界線講明，停下來優先，注意疲勞影響判斷", "單張塔羅／先把干擾移除，調整優先，避免衝動決策", "單張塔羅：先把順序排好，盤點優先，今天適合保守推進", "單張塔羅：先把重點抓住，溝通優先，留有彈性", "單張塔羅：先把條件寫清楚，執行優先，避免衝動決策", "單張塔羅／先把順序排好，收尾優先，不要同時開太多坑", "單張塔羅：先把界線講明，溝通優先，注意疲勞影響判斷", "單張塔羅：先把重點抓住，執行優先，留有彈性", "單張塔羅：先完成最小一步，執行優先，以可持續為準", "單張塔羅／先做低成本測試，執行優先，今天適合保守推進", "單張塔羅：先把重點抓住，確認優先，留有彈性", "單張塔羅：先把干擾移除，整理優先，注意疲勞影響判斷", "單張塔羅：先把資料補齊，執行優先，把握窗口期"], "C": ["門縫透亮：先修復再擴張，阻礙會以另一種方式消失（單張塔羅）", "骰面低語：與其求快不如求準；你會突然想通（單張塔羅）", "光線偏移：與其求快不如求準；今天的選擇會影響一週（單張塔羅）", "霧散：直覺比你想得可靠；你會突然想通（單張塔羅）", "光線偏移：直覺比你想得可靠；有貴人暗中推你一把（單張塔羅）", "籤意落定：直覺比你想得可靠；今天的選擇會影響一週（單張塔羅）", "線索浮現：該說清楚的就說清楚，你會收到明確確認（單張塔羅）", "門縫透亮：該說清楚的就說清楚；阻礙會以另一種方式消失（單張塔羅）", "線索浮現：先退半步就會看見路；你會在轉角遇到機會（單張塔羅）", "水面映照：答案在你忽略的細節；你會看見新的可能（單張塔羅）", "水面映照：與其求快不如求準；阻礙會以另一種方式消失（單張塔羅）", "籤意落定：直覺比你想得可靠；有貴人暗中推你一把（單張塔羅）", "水面映照：今天以守為攻，你會突然想通（單張塔羅）", "籤意落定：與其求快不如求準；某個人會主動靠近（單張塔羅）", "骰面低語：該結束的就結束；某個人會主動靠近（單張塔羅）", "星位轉動：你正在累積力量；某個人會主動靠近（單張塔羅）", "骰面低語：該說清楚的就說清楚；你會收到明確確認（單張塔羅）", "牌面回應：與其求快不如求準；你會突然想通（單張塔羅）", "霧散：該說清楚的就說清楚，你會在轉角遇到機會（單張塔羅）", "霧散：該說清楚的就說清楚；你會在轉角遇到機會（單張塔羅）"]}}, "orb": {"name": "水晶球", "type": "normal", "tones": {"A": ["聽好，把爛習慣砍掉，不然你會被自己氣死（水晶球）", "我看你是，把拖延停掉，不然你會被人看破手腳", "聽好，把爛習慣砍掉，不然等著翻車", "不用演，把手機放下，不然你會被自己氣死", "你醒醒，把手機放下，不然你會被自己氣死", "我看你是，把手機放下，不然你會被自己氣死（水晶球）", "你到底想怎樣，收手，不然事情只會更亂", "你到底想怎樣，先去睡，不然事情只會更亂", "你醒醒，把爛習慣砍掉，不然等著翻車", "不用演，閉嘴三秒，不然你會被人看破手腳", "別鬧，閉嘴三秒，不然事情只會更亂（水晶球）", "先別急著嘴硬，先去喝水，不然你會被人看破手腳", "聽好，先去喝水，不然這波水晶球就白忙", "先別急著嘴硬，把爛習慣砍掉，不然你會卡到發瘋", "聽好，收手，不然等著翻車", "我看你是，先把錢收好，不然你會一直原地打轉（水晶球）", "我說真的，去把訊息回掉，不然等著翻車", "我看你是，閉嘴三秒，不然明天你會哭", "講白了，去把訊息回掉，不然等著翻車", "先別急著嘴硬，先去喝水，不然等著翻車"], "B": ["水晶球／先把順序排好，調整優先，把節奏抓回來", "水晶球：先把資料補齊，整理優先，以可持續為準", "水晶球：先把界線講明，執行優先，不要同時開太多坑", "水晶球：先做低成本測試，停下來優先，不要同時開太多坑", "水晶球／先做低成本測試，規劃優先，把握窗口期", "水晶球：先把界線講明，調整優先，今天適合保守推進", "水晶球：先把條件寫清楚，備份優先，先做再迭代", "水晶球：先把干擾移除，溝通優先，先做再迭代", "水晶球／先把風險列出來，規劃優先，以穩定為先", "水晶球：先完成最小一步，整理優先，不要同時開太多坑", "水晶球：先把干擾移除，執行優先，不要同時開太多坑", "水晶球：先把順序排好，盤點優先，留有彈性", "水晶球／先把干擾移除，規劃優先，留有彈性", "水晶球：先把順序排好，規劃優先，把節奏抓回來", "水晶球：先把重點抓住，備份優先，以穩定為先", "水晶球：先把干擾移除，備份優先，以可持續為準", "水晶球／先完成最小一步，收尾優先，留有彈性", "水晶球：先把風險列出來，收尾優先，把節奏抓回來", "水晶球：先把資料補齊，停下來優先，把節奏抓回來", "水晶球：先把順序排好，調整優先，注意疲勞影響判斷"], "C": ["光線偏移：該結束的就結束，你會收到明確確認（水晶球）", "門縫透亮：該說清楚的就說清楚；你會突然想通（水晶球）", "牌面回應：與其求快不如求準；你會在轉角遇到機會（水晶球）", "輪盤停格：先退半步就會看見路；你會收到明確確認（水晶球）", "骰面低語：今天以守為攻；今天的選擇會影響一週（水晶球）", "線索浮現：先修復再擴張；你會突然想通（水晶球）", "光線偏移：你正在累積力量，你會收到明確確認（水晶球）", "門縫透亮：直覺比你想得可靠；某個人會主動靠近（水晶球）", "牌面回應：今天以守為攻；舊問題將被迫面對（水晶球）", "輪盤停格：先斷捨離再前進；某個人會主動靠近（水晶球）", "水面映照：該說清楚的就說清楚；有貴人暗中推你一把（水晶球）", "線索浮現：今天以守為攻；今天的選擇會影響一週（水晶球）", "霧散：該說清楚的就說清楚，舊問題將被迫面對（水晶球）", "籤意落定：先退半步就會看見路；你會看見新的可能（水晶球）", "牌面回應：先斷捨離再前進；舊問題將被迫面對（水晶球）", "輪盤停格：該結束的就結束；某個人會主動靠近（水晶球）", "水面映照：先退半步就會看見路；舊問題將被迫面對（水晶球）", "水面映照：先斷捨離再前進；你會收到明確確認（水晶球）", "水面映照：今天以守為攻，阻礙會以另一種方式消失（水晶球）", "水面映照：該結束的就結束；阻礙會以另一種方式消失（水晶球）"]}}, "wheel": {"name": "關鍵字輪盤", "type": "normal", "tones": {"A": ["開始啦，別拖", "收手啦，別拖", "改啦，別拖", "去睡啦，別拖", "去喝水啦，別拖", "撤退啦，別拖", "推進啦，別拖", "閉嘴啦，別拖", "整理啦，別拖", "行動啦，別拖", "拒絕啦，別拖", "存錢啦，別拖", "回訊息啦，別拖", "別賭啦，別拖", "別吵啦，別拖", "先做啦，別拖", "你就快點", "你就慢點", "你就別急", "你就別鬧"], "B": ["開始", "暫停", "觀察", "行動", "收斂", "放手", "堅持", "轉彎", "整理", "溝通", "休息", "先別急", "設定期限", "先寫下來", "先存再說", "先問清楚", "快速測試", "保守推進", "收尾", "開新局"], "C": ["光落在『開始』（輪盤示意）", "影停在『暫停』（輪盤示意）", "風指向『觀察』（輪盤示意）", "火催促『行動』（輪盤示意）", "霧提醒『收斂』（輪盤示意）", "潮帶來『放手』（輪盤示意）", "星守護『堅持』（輪盤示意）", "路暗示『轉彎』（輪盤示意）", "線索要你『整理』（輪盤示意）", "回聲叫你『溝通』（輪盤示意）", "脈動說『休息』（輪盤示意）", "籤意說『先別急』（輪盤示意）", "門示『設定期限』（輪盤示意）", "紙寫『先寫下來』（輪盤示意）", "錢包喊『先存再說』（輪盤示意）", "眼神要你『先問清楚』（輪盤示意）", "電流指『快速測試』（輪盤示意）", "石頭說『保守推進』（輪盤示意）", "日落說『收尾』（輪盤示意）", "日出說『開新局』（輪盤示意）"]}}, "gacha": {"name": "十連抽", "type": "normal", "tones": {"A": ["你醒醒，收手，不然事情只會更亂（十連抽）", "聽好，收手，不然你會一直原地打轉", "你醒醒，把那件事做完，不然明天你會哭", "講白了，先去睡，不然你會被自己氣死", "講白了，把拖延停掉，不然你會更累", "我看你是，閉嘴三秒，不然事情只會更亂（十連抽）", "別鬧，把手機放下，不然事情只會更亂", "聽好，先把錢收好，不然你又要後悔", "你醒醒，把手機放下，不然你會被人看破手腳", "你到底想怎樣，把手機放下，不然你會卡到發瘋", "聽好，把拖延停掉，不然事情只會更亂（十連抽）", "講白了，把手機放下，不然你會被人看破手腳", "不用演，把拖延停掉，不然你又要後悔", "聽好，先去喝水，不然明天你會哭", "不用演，先去喝水，不然你會卡到發瘋", "聽好，把拖延停掉，不然你會卡到發瘋（十連抽）", "講白了，收手，不然你會卡到發瘋", "講白了，閉嘴三秒，不然明天你會哭", "別鬧，先去睡，不然你會被人看破手腳", "我說真的，把爛習慣砍掉，不然今天就白忙"], "B": ["十連抽／先把資料補齊，收尾優先，今天適合保守推進", "十連抽：先把干擾移除，收尾優先，把握窗口期", "十連抽：先做低成本測試，盤點優先，把握窗口期", "十連抽：先把資料補齊，執行優先，先做再迭代", "十連抽／先把界線講明，收尾優先，以可持續為準", "十連抽：先把資料補齊，確認優先，不要同時開太多坑", "十連抽：先把時間排出來，停下來優先，以穩定為先", "十連抽：先做低成本測試，盤點優先，今天適合保守推進", "十連抽／先完成最小一步，溝通優先，以穩定為先", "十連抽：先把界線講明，執行優先，今天適合保守推進", "十連抽：先把干擾移除，盤點優先，留有彈性", "十連抽：先把條件寫清楚，溝通優先，今天適合保守推進", "十連抽／先完成最小一步，確認優先，把握窗口期", "十連抽：先完成最小一步，收尾優先，避免衝動決策", "十連抽：先把干擾移除，備份優先，注意疲勞影響判斷", "十連抽：先完成最小一步，溝通優先，不要同時開太多坑", "十連抽／先把順序排好，整理優先，先做再迭代", "十連抽：先完成最小一步，溝通優先，先做再迭代", "十連抽：先把資料補齊，整理優先，以可持續為準", "十連抽：先把界線講明，調整優先，先做再迭代"], "C": ["霧散：答案在你忽略的細節，你會看見新的可能（十連抽）", "星位轉動：先斷捨離再前進；舊問題將被迫面對（十連抽）", "骰面低語：今天以守為攻；某個人會主動靠近（十連抽）", "門縫透亮：答案在你忽略的細節；一個訊息會改變走向（十連抽）", "牌面回應：你正在累積力量；一個訊息會改變走向（十連抽）", "輪盤停格：你正在累積力量；舊問題將被迫面對（十連抽）", "輪盤停格：該結束的就結束，你會在轉角遇到機會（十連抽）", "星位轉動：該結束的就結束；你會收到明確確認（十連抽）", "牌面回應：先斷捨離再前進；今天的選擇會影響一週（十連抽）", "籤意落定：答案在你忽略的細節；今天的選擇會影響一週（十連抽）", "水面映照：先斷捨離再前進；有貴人暗中推你一把（十連抽）", "牌面回應：你正在累積力量；有貴人暗中推你一把（十連抽）", "門縫透亮：你正在累積力量，你會看見新的可能（十連抽）", "水面映照：答案在你忽略的細節；你會看見新的可能（十連抽）", "霧散：先修復再擴張；某個人會主動靠近（十連抽）", "水面映照：你正在累積力量；你會看見新的可能（十連抽）", "門縫透亮：與其求快不如求準；阻礙會以另一種方式消失（十連抽）", "門縫透亮：該結束的就結束；某個人會主動靠近（十連抽）", "門縫透亮：該說清楚的就說清楚，一個訊息會改變走向（十連抽）", "門縫透亮：該說清楚的就說清楚；阻礙會以另一種方式消失（十連抽）"]}}, "todo": {"name": "適合/不適合", "type": "normal", "tones": {"A": ["適合：收尾一件事，別裝死，懂？", "不適合：硬碰硬吵架，別裝死", "適合：盤點花費，別裝死", "不適合：情緒性發文，別裝死", "適合：備份檔案，別裝死", "不適合：賭氣追加投入，別裝死，懂？", "適合：喝水，別裝死", "不適合：賭氣追加投入，別裝死", "適合：收尾一件事，別裝死", "不適合：熬夜硬撐，別裝死", "適合：喝水，別裝死，懂？", "不適合：衝動下單，別裝死", "適合：回覆訊息，別裝死", "不適合：拖延小問題，別裝死", "適合：做最低成本版本，別裝死", "不適合：衝動下單，別裝死，懂？", "適合：散步放空，別裝死", "不適合：用猜的替代溝通，別裝死", "適合：盤點花費，別裝死，懂？", "不適合：一次開十個坑，別裝死，懂？"], "B": ["適合：盤點花費；建議依優先順序執行", "不適合：用猜的替代溝通；建議依優先順序執行", "適合：回覆訊息；建議依優先順序執行", "不適合：不看合約就答應；建議依優先順序執行", "適合：喝水；建議依優先順序執行", "不適合：情緒性發文；建議依優先順序執行", "適合：收尾一件事；建議依優先順序執行", "不適合：一次開十個坑；建議依優先順序執行", "不適合：拖延小問題；建議依優先順序執行", "不適合：衝動下單；建議依優先順序執行", "適合：做最低成本版本；建議依優先順序執行", "適合：備份檔案；建議依優先順序執行", "不適合：把責任全扛；建議依優先順序執行", "適合：早點睡；建議依優先順序執行", "適合：整理資料；建議依優先順序執行", "不適合：熬夜硬撐；建議依優先順序執行", "適合：把風險寫下來；建議依優先順序執行", "適合：散步放空；建議依優先順序執行", "不適合：硬碰硬吵架；建議依優先順序執行", "不適合：賭氣追加投入；建議依優先順序執行"], "C": ["宜：收尾一件事；你會看見新的可能", "忌：用猜的替代溝通；你會收到明確確認", "宜：備份檔案；你會突然想通", "忌：拖延小問題；有貴人暗中推你一把", "宜：做最低成本版本；今天的選擇會影響一週", "忌：不看合約就答應；你會收到明確確認", "宜：散步放空；阻礙會以另一種方式消失", "忌：拖延小問題；你會收到明確確認", "宜：備份檔案；你會收到明確確認", "忌：拖延小問題；某個人會主動靠近", "宜：回覆訊息；舊問題將被迫面對", "忌：熬夜硬撐；舊問題將被迫面對", "宜：整理資料；你會在轉角遇到機會", "忌：把責任全扛；你會收到明確確認", "忌：情緒性發文；一個訊息會改變走向", "宜：散步放空；有貴人暗中推你一把", "忌：賭氣追加投入；阻礙會以另一種方式消失", "宜：把風險寫下來；某個人會主動靠近", "忌：衝動下單；今天的選擇會影響一週", "宜：把風險寫下來；舊問題將被迫面對"]}}, "ritual": {"name": "抽獎儀式", "type": "normal", "tones": {"A": ["別鬧，先去喝水，不然事情只會更亂（抽獎儀式）", "我看你是，把爛習慣砍掉，不然明天你會哭", "別再自欺欺人，把手機放下，不然你會被人看破手腳", "我看你是，先去喝水，不然這波抽獎儀式就白忙", "先別急著嘴硬，去把訊息回掉，不然等著翻車", "聽好，先去睡，不然你又要後悔（抽獎儀式）", "你醒醒，把那件事做完，不然你會一直原地打轉", "我說真的，把手機放下，不然你又要後悔", "你到底想怎樣，去把訊息回掉，不然你會被自己氣死", "別鬧，先把錢收好，不然你會被自己氣死", "講白了，去把訊息回掉，不然你會一直原地打轉（抽獎儀式）", "不用演，把那件事做完，不然明天你會哭", "我說真的，把手機放下，不然明天你會哭", "別再自欺欺人，把那件事做完，不然事情只會更亂", "聽好，收手，不然你又要後悔（抽獎儀式）", "你到底想怎樣，把爛習慣砍掉，不然你會卡到發瘋", "我說真的，去把訊息回掉，不然今天就白忙", "我看你是，把那件事做完，不然等著翻車", "不用演，把那件事做完，不然今天就白忙", "聽好，先把錢收好，不然今天就白忙（抽獎儀式）"], "B": ["抽獎儀式／先把時間排出來，確認優先，今天適合保守推進", "抽獎儀式：先把資料補齊，收尾優先，把節奏抓回來", "抽獎儀式：先把條件寫清楚，停下來優先，以穩定為先", "抽獎儀式：先把干擾移除，溝通優先，把握窗口期", "抽獎儀式／先把界線講明，規劃優先，今天適合保守推進", "抽獎儀式：先把干擾移除，盤點優先，注意疲勞影響判斷", "抽獎儀式：先做低成本測試，溝通優先，今天適合保守推進", "抽獎儀式：先把順序排好，收尾優先，不要同時開太多坑", "抽獎儀式／先完成最小一步，規劃優先，不要同時開太多坑", "抽獎儀式：先做低成本測試，規劃優先，把握窗口期", "抽獎儀式：先把時間排出來，收尾優先，把握窗口期", "抽獎儀式：先把干擾移除，停下來優先，不要同時開太多坑", "抽獎儀式／先把干擾移除，溝通優先，今天適合保守推進", "抽獎儀式：先把時間排出來，收尾優先，先做再迭代", "抽獎儀式：先把干擾移除，收尾優先，先做再迭代", "抽獎儀式：先完成最小一步，停下來優先，避免衝動決策", "抽獎儀式／先把條件寫清楚，備份優先，今天適合保守推進", "抽獎儀式：先完成最小一步，執行優先，注意疲勞影響判斷", "抽獎儀式：先把重點抓住，盤點優先，留有彈性", "抽獎儀式：先完成最小一步，執行優先，把握窗口期"], "C": ["牌面回應：先退半步就會看見路，有貴人暗中推你一把（抽獎儀式）", "門縫透亮：直覺比你想得可靠；你會收到明確確認（抽獎儀式）", "霧散：先退半步就會看見路；舊問題將被迫面對（抽獎儀式）", "牌面回應：答案在你忽略的細節；有貴人暗中推你一把（抽獎儀式）", "骰面低語：答案在你忽略的細節；阻礙會以另一種方式消失（抽獎儀式）", "牌面回應：先退半步就會看見路；有貴人暗中推你一把（抽獎儀式）", "輪盤停格：直覺比你想得可靠，阻礙會以另一種方式消失（抽獎儀式）", "水面映照：答案在你忽略的細節；一個訊息會改變走向（抽獎儀式）", "骰面低語：答案在你忽略的細節；你會在轉角遇到機會（抽獎儀式）", "星位轉動：先斷捨離再前進；一個訊息會改變走向（抽獎儀式）", "籤意落定：你正在累積力量；一個訊息會改變走向（抽獎儀式）", "線索浮現：你正在累積力量；你會看見新的可能（抽獎儀式）", "星位轉動：你正在累積力量，阻礙會以另一種方式消失（抽獎儀式）", "霧散：先斷捨離再前進；有貴人暗中推你一把（抽獎儀式）", "輪盤停格：先斷捨離再前進；某個人會主動靠近（抽獎儀式）", "輪盤停格：直覺比你想得可靠；你會突然想通（抽獎儀式）", "線索浮現：你正在累積力量；舊問題將被迫面對（抽獎儀式）", "霧散：你正在累積力量；你會突然想通（抽獎儀式）", "水面映照：先修復再擴張，阻礙會以另一種方式消失（抽獎儀式）", "霧散：你正在累積力量；你會收到明確確認（抽獎儀式）"]}}, "dice": {"name": "骰子卜卦", "type": "normal", "tones": {"A": ["你醒醒，閉嘴三秒，不然你會卡到發瘋（骰子卜卦）", "不用演，去把訊息回掉，不然你會卡到發瘋", "你醒醒，把拖延停掉，不然你會更累", "你醒醒，把那件事做完，不然你會更累", "我說真的，把那件事做完，不然明天你會哭", "你醒醒，把手機放下，不然等著翻車（骰子卜卦）", "先別急著嘴硬，先去睡，不然事情只會更亂", "先別急著嘴硬，收手，不然你會一直原地打轉", "不用演，先去睡，不然你會更累", "聽好，先去睡，不然你會一直原地打轉", "我說真的，把拖延停掉，不然你會卡到發瘋（骰子卜卦）", "別再自欺欺人，去把訊息回掉，不然你會被人看破手腳", "先別急著嘴硬，先去睡，不然明天你會哭", "你醒醒，去把訊息回掉，不然你又要後悔", "我說真的，把爛習慣砍掉，不然今天就白忙", "別鬧，去把訊息回掉，不然這波骰子卜卦就白忙（骰子卜卦）", "我看你是，把手機放下，不然等著翻車", "別鬧，先去喝水，不然你會被自己氣死", "別鬧，閉嘴三秒，不然你會一直原地打轉", "別再自欺欺人，把爛習慣砍掉，不然明天你會哭"], "B": ["骰子卜卦／先把界線講明，停下來優先，不要同時開太多坑", "骰子卜卦：先完成最小一步，收尾優先，以穩定為先", "骰子卜卦：先做低成本測試，收尾優先，今天適合保守推進", "骰子卜卦：先完成最小一步，確認優先，今天適合保守推進", "骰子卜卦／先做低成本測試，盤點優先，今天適合保守推進", "骰子卜卦：先完成最小一步，整理優先，避免衝動決策", "骰子卜卦：先把條件寫清楚，收尾優先，今天適合保守推進", "骰子卜卦：先做低成本測試，執行優先，先做再迭代", "骰子卜卦／先把條件寫清楚，停下來優先，先做再迭代", "骰子卜卦：先把資料補齊，盤點優先，把節奏抓回來", "骰子卜卦：先把重點抓住，盤點優先，先做再迭代", "骰子卜卦：先完成最小一步，收尾優先，不要同時開太多坑", "骰子卜卦／先做低成本測試，盤點優先，避免衝動決策", "骰子卜卦：先把條件寫清楚，調整優先，以穩定為先", "骰子卜卦：先把時間排出來，確認優先，先做再迭代", "骰子卜卦：先把資料補齊，停下來優先，以可持續為準", "骰子卜卦／先做低成本測試，溝通優先，把握窗口期", "骰子卜卦：先把順序排好，整理優先，注意疲勞影響判斷", "骰子卜卦：先把界線講明，規劃優先，不要同時開太多坑", "骰子卜卦：先完成最小一步，溝通優先，不要同時開太多坑"], "C": ["水面映照：直覺比你想得可靠，有貴人暗中推你一把（骰子卜卦）", "霧散：該結束的就結束；你會收到明確確認（骰子卜卦）", "光線偏移：與其求快不如求準；你會看見新的可能（骰子卜卦）", "水面映照：該結束的就結束；你會突然想通（骰子卜卦）", "光線偏移：該說清楚的就說清楚；阻礙會以另一種方式消失（骰子卜卦）", "水面映照：先斷捨離再前進；你會收到明確確認（骰子卜卦）", "霧散：該說清楚的就說清楚，你會突然想通（骰子卜卦）", "牌面回應：答案在你忽略的細節；一個訊息會改變走向（骰子卜卦）", "籤意落定：與其求快不如求準；今天的選擇會影響一週（骰子卜卦）", "輪盤停格：該結束的就結束；阻礙會以另一種方式消失（骰子卜卦）", "門縫透亮：與其求快不如求準；一個訊息會改變走向（骰子卜卦）", "牌面回應：你正在累積力量；你會看見新的可能（骰子卜卦）", "霧散：該結束的就結束，一個訊息會改變走向（骰子卜卦）", "光線偏移：今天以守為攻；某個人會主動靠近（骰子卜卦）", "霧散：你正在累積力量；你會在轉角遇到機會（骰子卜卦）", "光線偏移：先修復再擴張；你會在轉角遇到機會（骰子卜卦）", "牌面回應：該結束的就結束；你會看見新的可能（骰子卜卦）", "牌面回應：先斷捨離再前進；舊問題將被迫面對（骰子卜卦）", "星位轉動：該結束的就結束，有貴人暗中推你一把（骰子卜卦）", "霧散：先退半步就會看見路；你會看見新的可能（骰子卜卦）"]}}, "reverse": {"name": "反向占卜", "type": "reverse", "stages": {"1": {"A": ["A1-1：當然可以拖，拖到爆再說", "A1-2：先別睡，反正你很愛累", "A1-3：溝通？不用啦，用猜的多浪漫", "A1-4：先買再說，錢會自己長出來（並不會）", "A1-5：把事情留到最後一刻，刺激嘛", "A1-6：不整理也行，反正你喜歡找不到", "A1-7：先答應再想，後悔最有味道", "A1-8：備份？不用啦，壞一次你就記得了", "A1-9：把界線拿去丟，大家踩你比較方便", "A1-10：你就硬扛，扛到扛不住再求救"], "B": ["B1-1：建議不要照做：當然可以拖，拖到爆再說", "B1-2：建議不要照做：先別睡，反正你很愛累", "B1-3：建議不要照做：溝通？不用啦，用猜的多浪漫", "B1-4：建議不要照做：先買再說，錢會自己長出來（並不會）", "B1-5：建議不要照做：把事情留到最後一刻，刺激嘛", "B1-6：建議不要照做：不整理也行，反正你喜歡找不到", "B1-7：建議不要照做：先答應再想，後悔最有味道", "B1-8：建議不要照做：備份？不用啦，壞一次你就記得了", "B1-9：建議不要照做：把界線拿去丟，大家踩你比較方便", "B1-10：建議不要照做：你就硬扛，扛到扛不住再求救"], "C": ["C1-1：黑霧低語：當然可以拖，拖到爆再說（反向籤）", "C1-2：黑霧低語：先別睡，反正你很愛累（反向籤）", "C1-3：黑霧低語：溝通？不用啦，用猜的多浪漫（反向籤）", "C1-4：黑霧低語：先買再說，錢會自己長出來（並不會）（反向籤）", "C1-5：黑霧低語：把事情留到最後一刻，刺激嘛（反向籤）", "C1-6：黑霧低語：不整理也行，反正你喜歡找不到（反向籤）", "C1-7：黑霧低語：先答應再想，後悔最有味道（反向籤）", "C1-8：黑霧低語：備份？不用啦，壞一次你就記得了（反向籤）", "C1-9：黑霧低語：把界線拿去丟，大家踩你比較方便（反向籤）", "C1-10：黑霧低語：你就硬扛，扛到扛不住再求救（反向籤）"]}, "2": {"A": ["A2-1：再拖啊，你是想把自己拖成標本？", "A2-2：別喝水，口乾舌燥才配得上你", "A2-3：你又在嘴硬了，先停一下好嗎", "A2-4：衝動下單吧，反正你很會心痛", "A2-5：別看風險，翻車才有劇情", "A2-6：先吵起來，輸了再來哭", "A2-7：一次開十個坑，然後十個都爛尾，完美", "A2-8：別回訊息，讓對方猜你在幹嘛，超成熟", "A2-9：把責任全扛，扛到爆炸就解脫了", "A2-10：你就繼續熬夜，明天再跟自己算帳"], "B": ["B2-1：建議不要照做：再拖啊，你是想把自己拖成標本？", "B2-2：建議不要照做：別喝水，口乾舌燥才配得上你", "B2-3：建議不要照做：你又在嘴硬了，先停一下好嗎", "B2-4：建議不要照做：衝動下單吧，反正你很會心痛", "B2-5：建議不要照做：別看風險，翻車才有劇情", "B2-6：建議不要照做：先吵起來，輸了再來哭", "B2-7：建議不要照做：一次開十個坑，然後十個都爛尾，完美", "B2-8：建議不要照做：別回訊息，讓對方猜你在幹嘛，超成熟", "B2-9：建議不要照做：把責任全扛，扛到爆炸就解脫了", "B2-10：建議不要照做：你就繼續熬夜，明天再跟自己算帳"], "C": ["C2-1：黑霧低語：再拖啊，你是想把自己拖成標本？（反向籤）", "C2-2：黑霧低語：別喝水，口乾舌燥才配得上你（反向籤）", "C2-3：黑霧低語：你又在嘴硬了，先停一下好嗎（反向籤）", "C2-4：黑霧低語：衝動下單吧，反正你很會心痛（反向籤）", "C2-5：黑霧低語：別看風險，翻車才有劇情（反向籤）", "C2-6：黑霧低語：先吵起來，輸了再來哭（反向籤）", "C2-7：黑霧低語：一次開十個坑，然後十個都爛尾，完美（反向籤）", "C2-8：黑霧低語：別回訊息，讓對方猜你在幹嘛，超成熟（反向籤）", "C2-9：黑霧低語：把責任全扛，扛到爆炸就解脫了（反向籤）", "C2-10：黑霧低語：你就繼續熬夜，明天再跟自己算帳（反向籤）"]}, "3": {"A": ["A3-1：你現在這狀態還想硬推？你是想被現實打臉到醒不了？", "A3-2：別休息，倒下去就不用煩了，聰明", "A3-3：繼續賭氣追加投入啊，反正你最愛把洞挖更大", "A3-4：不溝通就別怪誤會，反正你靠誤會活著", "A3-5：別做最低成本版本，直接把時間和錢一起燒掉，豪邁", "A3-6：你就繼續裝沒事，然後事情直接炸給你看", "A3-7：把存錢這件事當笑話就好，笑著笑著就窮一輩子", "A3-8：再拖一次試試，你會看到自己多會自毀", "A3-9：你不是缺方法，你是缺自制力，先承認", "A3-10：收尾？不用啦，爛在那裡比較符合你現在的氣場"], "B": ["B3-1：建議不要照做：你現在這狀態還想硬推？你是想被現實打臉到醒不了？", "B3-2：建議不要照做：別休息，倒下去就不用煩了，聰明", "B3-3：建議不要照做：繼續賭氣追加投入啊，反正你最愛把洞挖更大", "B3-4：建議不要照做：不溝通就別怪誤會，反正你靠誤會活著", "B3-5：建議不要照做：別做最低成本版本，直接把時間和錢一起燒掉，豪邁", "B3-6：建議不要照做：你就繼續裝沒事，然後事情直接炸給你看", "B3-7：建議不要照做：把存錢這件事當笑話就好，笑著笑著就窮一輩子", "B3-8：建議不要照做：再拖一次試試，你會看到自己多會自毀", "B3-9：建議不要照做：你不是缺方法，你是缺自制力，先承認", "B3-10：建議不要照做：收尾？不用啦，爛在那裡比較符合你現在的氣場"], "C": ["C3-1：黑霧低語：你現在這狀態還想硬推？你是想被現實打臉到醒不了？（反向籤）", "C3-2：黑霧低語：別休息，倒下去就不用煩了，聰明（反向籤）", "C3-3：黑霧低語：繼續賭氣追加投入啊，反正你最愛把洞挖更大（反向籤）", "C3-4：黑霧低語：不溝通就別怪誤會，反正你靠誤會活著（反向籤）", "C3-5：黑霧低語：別做最低成本版本，直接把時間和錢一起燒掉，豪邁（反向籤）", "C3-6：黑霧低語：你就繼續裝沒事，然後事情直接炸給你看（反向籤）", "C3-7：黑霧低語：把存錢這件事當笑話就好，笑著笑著就窮一輩子（反向籤）", "C3-8：黑霧低語：再拖一次試試，你會看到自己多會自毀（反向籤）", "C3-9：黑霧低語：你不是缺方法，你是缺自制力，先承認（反向籤）", "C3-10：黑霧低語：收尾？不用啦，爛在那裡比較符合你現在的氣場（反向籤）"]}}}, "npc": {"name": "NPC 台詞", "type": "npc", "modes": {"snark": {"name": "嘴臭NPC", "tones": {"A": ["你在幹嘛，先整理，不然你又要後悔", "醒醒，先停一下，不然你明天會更慘", "你又來了，別再拖，不然你明天會更慘", "你又來了，先整理，不然我都替你尷尬", "別裝忙，先把手上的做完，不然你又要後悔", "喂，先回訊息，不然等著翻車", "拜託，先停一下，不然等著翻車", "醒醒，先整理，不然你明天會更慘", "你又來了，先回訊息，不然等著翻車", "拜託，先把錢守住，不然我都替你尷尬", "喂，先回訊息，不然你自己看著辦", "先聽我講，先回訊息，不然我都替你尷尬", "你在幹嘛，先把錢守住，不然你又要後悔", "你在幹嘛，別再拖，不然我都替你尷尬", "別裝忙，別再嘴硬，不然你明天會更慘", "別裝忙，先把錢守住，不然你明天會更慘", "別裝忙，別再拖，不然你又要後悔", "你又來了，別再嘴硬，不然等著翻車", "先聽我講，別再嘴硬，不然你明天會更慘", "別裝忙，先整理，不然你自己看著辦"], "B": ["NPC：先做低成本測試，優先處理『備份』，先做再迭代", "NPC：先把時間排出來，優先處理『停下來』，注意疲勞影響判斷", "NPC：先做低成本測試，優先處理『確認』，注意疲勞影響判斷", "NPC：先做低成本測試，優先處理『收尾』，把握窗口期", "NPC：先把條件寫清楚，優先處理『確認』，不要同時開太多坑", "NPC：先把順序排好，優先處理『調整』，把握窗口期", "NPC：先把條件寫清楚，優先處理『停下來』，以可持續為準", "NPC：先把界線講明，優先處理『執行』，留有彈性", "NPC：先完成最小一步，優先處理『整理』，今天適合保守推進", "NPC：先把界線講明，優先處理『確認』，今天適合保守推進", "NPC：先完成最小一步，優先處理『溝通』，先做再迭代", "NPC：先把風險列出來，優先處理『收尾』，以可持續為準", "NPC：先把干擾移除，優先處理『規劃』，把節奏抓回來", "NPC：先把資料補齊，優先處理『執行』，以穩定為先", "NPC：先把風險列出來，優先處理『整理』，以可持續為準", "NPC：先把順序排好，優先處理『溝通』，以穩定為先", "NPC：先把干擾移除，優先處理『確認』，今天適合保守推進", "NPC：先把條件寫清楚，優先處理『盤點』，避免衝動決策", "NPC：先把資料補齊，優先處理『收尾』，先做再迭代", "NPC：先把條件寫清楚，優先處理『規劃』，不要同時開太多坑"], "C": ["NPC低語：骰面低語，該結束的就結束，舊問題將被迫面對", "NPC低語：光線偏移，先退半步就會看見路，你會收到明確確認", "NPC低語：門縫透亮，與其求快不如求準，你會看見新的可能", "NPC低語：霧散，與其求快不如求準，某個人會主動靠近", "NPC低語：霧散，該結束的就結束，你會看見新的可能", "NPC低語：門縫透亮，答案在你忽略的細節，阻礙會以另一種方式消失", "NPC低語：線索浮現，你正在累積力量，今天的選擇會影響一週", "NPC低語：牌面回應，該結束的就結束，你會看見新的可能", "NPC低語：骰面低語，先斷捨離再前進，一個訊息會改變走向", "NPC低語：骰面低語，先斷捨離再前進，你會看見新的可能", "NPC低語：牌面回應，與其求快不如求準，你會在轉角遇到機會", "NPC低語：霧散，今天以守為攻，你會看見新的可能", "NPC低語：門縫透亮，先修復再擴張，今天的選擇會影響一週", "NPC低語：門縫透亮，今天以守為攻，你會看見新的可能", "NPC低語：籤意落定，今天以守為攻，一個訊息會改變走向", "NPC低語：光線偏移，與其求快不如求準，有貴人暗中推你一把", "NPC低語：牌面回應，該結束的就結束，有貴人暗中推你一把", "NPC低語：籤意落定，答案在你忽略的細節，阻礙會以另一種方式消失", "NPC低語：門縫透亮，先退半步就會看見路，一個訊息會改變走向", "NPC低語：光線偏移，你正在累積力量，舊問題將被迫面對"]}}, "heal": {"name": "療癒NPC", "tones": {"A": ["可以的，先把壓力放下，今天到這裡也行", "先放過自己，先把壓力放下，我在", "別怕，先把心跳放慢，你已經很努力了", "你很撐了，先把心跳放慢，你做得到", "你很撐了，先把壓力放下，你不是一個人扛", "別怕，先喝點水，你做得到", "先放過自己，先把界線立好，我在", "我知道你累，先把注意力拉回來，你不是一個人扛", "我知道你累，先把壓力放下，你做得到", "可以的，先把界線立好，我在", "先停一下，先做最小一步，慢慢來就好", "可以的，先把壓力放下，你做得到", "先放過自己，先把心跳放慢，你做得到", "別怕，先把界線立好，慢慢來就好", "先慢一點，先把今天收尾，你已經很努力了", "我知道你累，先喝點水，我在", "你很撐了，先把壓力放下，慢慢來就好", "別怕，先把界線立好，我在", "聽我說，先把今天收尾，你已經很努力了", "可以的，先做最小一步，今天到這裡也行"], "B": ["NPC：先把界線講明；採取調整策略，不要同時開太多坑", "NPC：先把資料補齊；採取確認策略，把握窗口期", "NPC：先把順序排好；採取確認策略，把節奏抓回來", "NPC：先做低成本測試；採取盤點策略，今天適合保守推進", "NPC：先把條件寫清楚；採取停下來策略，以穩定為先", "NPC：先把界線講明；採取收尾策略，以穩定為先", "NPC：先把干擾移除；採取執行策略，不要同時開太多坑", "NPC：先把干擾移除；採取執行策略，避免衝動決策", "NPC：先把條件寫清楚；採取收尾策略，把節奏抓回來", "NPC：先把時間排出來；採取停下來策略，以穩定為先", "NPC：先把界線講明；採取備份策略，注意疲勞影響判斷", "NPC：先把重點抓住；採取收尾策略，以穩定為先", "NPC：先完成最小一步；採取確認策略，留有彈性", "NPC：先把風險列出來；採取收尾策略，避免衝動決策", "NPC：先把順序排好；採取溝通策略，把握窗口期", "NPC：先把順序排好；採取收尾策略，注意疲勞影響判斷", "NPC：先把時間排出來；採取規劃策略，以可持續為準", "NPC：先把時間排出來；採取調整策略，今天適合保守推進", "NPC：先把資料補齊；採取整理策略，把握窗口期", "NPC：先把條件寫清楚；採取停下來策略，把節奏抓回來"], "C": ["守護訊息：光線偏移，直覺比你想得可靠；阻礙會以另一種方式消失", "守護訊息：牌面回應，與其求快不如求準；你會突然想通", "守護訊息：光線偏移，答案在你忽略的細節；某個人會主動靠近", "守護訊息：光線偏移，你正在累積力量；舊問題將被迫面對", "守護訊息：霧散，該結束的就結束；今天的選擇會影響一週", "守護訊息：水面映照，與其求快不如求準；阻礙會以另一種方式消失", "守護訊息：輪盤停格，先修復再擴張；你會在轉角遇到機會", "守護訊息：骰面低語，先修復再擴張；你會突然想通", "守護訊息：光線偏移，先斷捨離再前進；你會突然想通", "守護訊息：籤意落定，先斷捨離再前進；你會收到明確確認", "守護訊息：籤意落定，先退半步就會看見路；一個訊息會改變走向", "守護訊息：牌面回應，先修復再擴張；你會看見新的可能", "守護訊息：牌面回應，該結束的就結束；你會在轉角遇到機會", "守護訊息：骰面低語，答案在你忽略的細節；一個訊息會改變走向", "守護訊息：霧散，今天以守為攻；你會在轉角遇到機會", "守護訊息：星位轉動，先斷捨離再前進；你會在轉角遇到機會", "守護訊息：霧散，答案在你忽略的細節；你會在轉角遇到機會", "守護訊息：門縫透亮，你正在累積力量；舊問題將被迫面對", "守護訊息：門縫透亮，先退半步就會看見路；一個訊息會改變走向", "守護訊息：霧散，直覺比你想得可靠；阻礙會以另一種方式消失"]}}}}}};
const TONE_KEYS = ["A","B","C"];

function getTone(rng){
  const t = state.tone || "mix";
  if(t === "mix") return pickOne(TONE_KEYS, rng);
  return (t === "A" || t === "B" || t === "C") ? t : "B";
}
function toneLabel(t){
  return "";
}
function getPoolFor(gameId, rng){
  const t = getTone(rng);
  if(gameId==="npc"){
    const modeKey = (state.npcMode==="soft") ? "heal" : "snark";
    const pool = PHRASES.games.npc.modes[modeKey].tones[t];
    return { tone:t, pool, meta:{modeKey} };
  }
  if(gameId==="reverse"){
    const st = Math.max(1, Math.min(3, state.reverseStage||1));
    const pool = PHRASES.games.reverse.stages[String(st)][t];
    return { tone:t, pool, meta:{stage:st} };
  }
  const g = PHRASES.games[gameId];
  const pool = (g && g.tones && g.tones[t]) ? g.tones[t] : [];
  return { tone:t, pool, meta:{} };
}

function pickPhrase(gameId, scope){
  const rng = getRng(scope||gameId);
  const {tone, pool, meta} = getPoolFor(gameId, rng);
  const text = pickOne(pool, rng);
  return { tone, text, meta };
}

function pickTodoPair(scope){
  const rng = getRng(scope||"todo");
  const {tone, pool} = getPoolFor("todo", rng);
  const goodPrefixes = ["適合：","宜："];
  const badPrefixes  = ["不適合：","忌："];
  const goods = pool.filter(s => goodPrefixes.some(p=>s.startsWith(p)));
  const bads  = pool.filter(s => badPrefixes.some(p=>s.startsWith(p)));
  const doText = goods.length ? pickOne(goods,rng) : pickOne(pool,rng);
  const dontText = bads.length ? pickOne(bads,rng) : pickOne(pool,rng);
  return { tone, doText, dontText };
}

// 1) 籤筒
  const LOTS = [
    { title:"上上籤", text:"今天適合做一件你一直拖著的事。\n先動一下，後面會順到你自己都覺得誇張。", vibe:"good" },
    { title:"上籤", text:"你今天的關鍵是：不要急。\n慢一點反而會更快到終點。", vibe:"good" },
    { title:"中籤", text:"今天走穩就好。\n不需要贏很大，別輸掉情緒就已經是贏。", vibe:"warn" },
    { title:"中籤", text:"有人會讓你分心。\n你如果不接招，這回合你就贏。", vibe:"warn" },
    { title:"下籤", text:"今天不適合硬拚。\n能躲的坑就躲，能晚點回的訊息就晚點回。", vibe:"bad" },
    { title:"怪籤", text:"你今天最容易輸在：手賤。\n請把「再抽一次」當成一種修行。", vibe:"warn" },
    { title:"怪籤", text:"今天你不是沒運氣，你是太有戲。\n別把小事演成大結局。", vibe:"warn" },
    { title:"怪籤", text:"今天你抽到這支籤，代表宇宙要你喝水。\n去喝。", vibe:"good" },
    { title:"下籤", text:"今天要少做「情緒型決策」。\n你先睡一覺，明天你會感謝你自己。", vibe:"bad" },
    { title:"上籤", text:"今天會有一個小驚喜。\n不是大富大貴，但足夠讓你心情好一點。", vibe:"good" },
    { title:"中籤", text:"今天適合整理。\n整理房間、整理腦袋、整理那個不想面對的清單。", vibe:"warn" },
    { title:"上上籤", text:"你今天的運勢屬於「越做越順」。\n只要開始，就會越來越好。", vibe:"good" },
    { title:"怪籤", text:"今天別和世界吵架。\n你吵不贏，世界還會回你已讀不回。", vibe:"warn" },
    { title:"下籤", text:"今天容易被小事激怒。\n你不是脾氣差，你只是累了。", vibe:"bad" },
    { title:"中籤", text:"今天適合觀望。\n先看別人怎麼翻車，你再決定要不要上場。", vibe:"warn" },
    { title:"怪籤", text:"今天別測試你的耐心。\n因為你根本沒有。", vibe:"bad" },
    { title:"上籤", text:"你今天適合把一件事做『到剛好』。\n做到 80 分就收手，剩下 20 分留給明天。", vibe:"good" },
  ];

  // 2) 三門
  const DOORS = [
    { title:"好事", text:"你選到一扇會讓你心情變好的門。\n今天如果有一個你猶豫的小事，直接做，會爽。", vibe:"good" },
    { title:"普通", text:"你選到一扇很正常的門。\n今天不會爆爽，但也不會爆炸，穩穩過關。", vibe:"warn" },
    { title:"翻車", text:"你選到一扇會讓你想翻白眼的門。\n但放心，這種倒楣通常只會出現在小事上。", vibe:"bad" },
    { title:"好事", text:"你今天適合先做最麻煩的那件事。\n做完之後整天都會輕。", vibe:"good" },
    { title:"普通", text:"今天的重點是：不要加戲。\n事情會自己往好的方向走。", vibe:"warn" },
    { title:"翻車", text:"今天別衝動買東西。\n你買的不是商品，你買的是後悔。", vibe:"bad" },
    { title:"好事", text:"有人會給你一個小幫助。\n你只要開口，就會有人接住你。", vibe:"good" },
    { title:"普通", text:"今天適合把期待降低。\n不是會變差，而是會更舒服。", vibe:"warn" },
    { title:"翻車", text:"今天如果硬要證明自己是對的，你就會輸掉氣氛。\n氣氛輸了就全輸。", vibe:"bad" },
  ];

  // 3) 單張塔羅（自創可愛版）
  const TAROT = [
    { name:"月亮的門縫", text:"你看到的只是片段。\n先別急著下結論，等訊息完整再判斷。", vibe:"warn" },
    { name:"倒扣的杯", text:"你不是不行，你是滿了。\n把注意力收回自己，今天先補能量。", vibe:"bad" },
    { name:"貓的尾巴", text:"別追答案。\n你越追越跑，放鬆反而會自己出現。", vibe:"good" },
    { name:"熄火的煙花", text:"不要硬撐。\n今天適合休息一下再上。", vibe:"bad" },
    { name:"緩慢的齒輪", text:"進度慢不是壞事。\n你在做的是能長久的東西。", vibe:"warn" },
    { name:"玻璃糖", text:"今天會有一個小甜。\n但別貪多，甜到剛好最好。", vibe:"good" },
    { name:"雲上的梯子", text:"機會在上面。\n你只要往前一步，就會看到下一步。", vibe:"good" },
    { name:"沉默的盾", text:"今天最強的防禦是：不回應。\n你不接招就不會受傷。", vibe:"warn" },
    { name:"風的信", text:"有人會給你一個提示。\n你如果有靈感，立刻記下來。", vibe:"good" },
    { name:"裂縫的光", text:"今天不是順，但會好。\n你只要撐過那個點，後面就亮。", vibe:"warn" },
    { name:"反方向", text:"你越想控制，越失控。\n今天試試看放手一點。", vibe:"warn" },
    { name:"小火", text:"你有能量，但要用在對的地方。\n別拿去跟爛事較勁。", vibe:"good" },
  ];

  // 4) 水晶球
  const ORB = [
    { title:"是", text:"就做。\n不要拖，越拖越沒氣勢。", vibe:"good" },
    { title:"否", text:"先別。\n你現在的狀態不適合硬推。", vibe:"bad" },
    { title:"可能", text:"可以，但要看你願不願意付出代價。\n代價通常是：時間或耐心。", vibe:"warn" },
    { title:"再問一次", text:"你問這個問題其實不是要答案。\n你只是想被允許。", vibe:"warn" },
    { title:"別想了", text:"你已經想太久。\n去做最小的一步就好。", vibe:"good" },
    { title:"不必證明", text:"不用證明你是對的。\n今天適合把力氣省下來。", vibe:"warn" },
    { title:"先睡", text:"你現在的腦子不可靠。\n先睡再決定。", vibe:"good" },
    { title:"拖一下", text:"不是不做，是晚點做。\n等情緒退了再上。", vibe:"warn" },
  ];

  // 5) 關鍵字輪盤
  const KEYWORDS = [
    { title:"低調", text:"今天適合安靜做事。\n你不需要被看見，也一樣能把事做漂亮。", vibe:"warn" },
    { title:"衝", text:"今天適合出手。\n猶豫只會讓你錯過那個窗口。", vibe:"good" },
    { title:"收斂", text:"今天不要嘴硬。\n你退一步反而會贏更多。", vibe:"warn" },
    { title:"放鬆", text:"今天適合把節奏放慢。\n你不是落後，你是在充電。", vibe:"good" },
    { title:"觀望", text:"今天先看局勢。\n等到你覺得「差不多了」再動。", vibe:"warn" },
    { title:"整理", text:"今天整理一次，明天省十次。\n把雜訊清掉，心會很爽。", vibe:"good" },
    { title:"不要買", text:"今天買東西容易買到後悔。\n你要的其實是情緒，不是商品。", vibe:"bad" },
    { title:"別回", text:"今天有些訊息不回更好。\n沉默就是你的護盾。", vibe:"warn" },
    { title:"先做", text:"先做最小版本。\n你只要開始，就會停不下來。", vibe:"good" },
    { title:"躺平", text:"今天你不需要拚。\n你只要活著就很強了。", vibe:"good" },
    { title:"清醒", text:"今天別被情緒帶著走。\n你清醒一點，事情就會清楚。", vibe:"warn" },
    { title:"不解釋", text:"今天不用解釋太多。\n懂的人自然懂，不懂的人你講再多也沒用。", vibe:"good" },
  ];

  // 6) NPC 台詞
  const NPC_SPICY = [
    { title:"NPC：嘴臭模式", text:"你今天最大的敵人不是別人，是你那隻不安分的手。\n別亂點、別亂買、別亂回。", vibe:"warn" },
    { title:"NPC：嘴臭模式", text:"你不是沒能力，你是太愛懷疑自己。\n先做再說，做了才有資格嫌。", vibe:"good" },
    { title:"NPC：嘴臭模式", text:"你今天如果再拖延，你就會被明天的你罵。\n而且罵得很難聽。", vibe:"bad" },
    { title:"NPC：嘴臭模式", text:"你剛剛那個衝動，如果你硬上，等一下就會後悔。\n別裝不信邪。", vibe:"bad" },
    { title:"NPC：嘴臭模式", text:"今天別和人爭輸贏。\n你贏了也不會變快樂。", vibe:"warn" },
    { title:"NPC：嘴臭模式", text:"你今天需要的不是答案，是睡眠。\n去睡。", vibe:"good" },
    { title:"NPC：嘴臭模式", text:"你其實早就知道該怎麼做。\n你只是想有人替你背鍋。", vibe:"warn" },
    { title:"NPC：嘴臭模式", text:"你現在的狀態不適合做大決策。\n你適合先去洗臉。", vibe:"warn" },
  ];
  const NPC_SOFT = [
    { title:"NPC：療癒模式", text:"今天慢一點也沒關係。\n你不是落後，你只是走得比較穩。", vibe:"good" },
    { title:"NPC：療癒模式", text:"你已經很努力了。\n今天只要完成一件小事就好。", vibe:"good" },
    { title:"NPC：療癒模式", text:"如果你覺得卡住，先休息。\n休息不是放棄，是補回你自己。", vibe:"warn" },
    { title:"NPC：療癒模式", text:"你不需要一直撐。\n可以找個讓你安心的節奏。", vibe:"warn" },
    { title:"NPC：療癒模式", text:"你會過去的。\n而且你會比你想像得更強。", vibe:"good" },
    { title:"NPC：療癒模式", text:"今天把自己照顧好，就是最好的決策。\n其他的明天再說。", vibe:"good" },
    { title:"NPC：療癒模式", text:"你不必一次做到完美。\n做到『能前進』就夠了。", vibe:"good" },
    { title:"NPC：療癒模式", text:"你被理解的機率，比你想的高。\n先把話說清楚就好。", vibe:"warn" },
  ];

  // 7) 十連抽（純娛樂）
  const GACHA_POOL = [
    { r:"SSR", name:"天選之人", vibe:"good", text:"今天你一出手就很像主角。\n把最難的那件事先做掉。" },
    { r:"SSR", name:"逆轉勝", vibe:"good", text:"你今天會在不被看好的地方扳回一城。\n不要先放棄。" },
    { r:"SSR", name:"爽到不真實", vibe:"good", text:"今天有一個小驚喜會讓你覺得離譜。\n收下，不用客氣。" },
    { r:"SR", name:"穩穩推進", vibe:"warn", text:"你今天的優勢是穩。\n別被別人的節奏拖走。" },
    { r:"SR", name:"小加成", vibe:"good", text:"今天做事效率比平常好一點。\n趁這波把待辦清掉。" },
    { r:"SR", name:"你有盾", vibe:"warn", text:"今天不怕吵。\n你只要不回應，事情就傷不到你。" },
    { r:"R", name:"普通日", vibe:"warn", text:"今天就普通。\n普通其實很難得。" },
    { r:"R", name:"小雷", vibe:"bad", text:"今天容易在小事翻車。\n別急、別硬、別嘴硬。" },
    { r:"R", name:"拖延怪", vibe:"bad", text:"今天最危險的是拖。\n先做 5 分鐘就好。" },
  ];
  function rollGachaRarity(rng){
    // purely for fun: ~6% SSR, ~24% SR, rest R
    const x = rng();
    if(x < 0.06) return "SSR";
    if(x < 0.30) return "SR";
    return "R";
  }

  // 8) 適合做 / 不適合做
  const DO_LIST = [
    "整理桌面", "把一件事做完 80%", "喝水", "把訊息晚點回", "先做最麻煩那件", "走出去三分鐘",
    "把該丟的丟掉", "把錢包/鑰匙整理好", "把腦袋清空 10 分鐘", "把一個坑補起來", "做一點運動"
  ];
  const DONT_LIST = [
    "衝動購物", "跟人吵架", "深夜發長訊息", "硬要證明自己", "用情緒做決策", "把小事演成大事",
    "在很累的時候下重大決定", "跟不重要的人糾纏", "一直重抽直到不滿意", "亂答應別人"
  ];

  // 9) 抽獎儀式輪盤
  const RITUALS = [
    { title:"先喝水", text:"喝一口再抽。\n你不是迷信，你是補電。", vibe:"good" },
    { title:"先洗手", text:"洗一下再來。\n儀式感就是爽感。", vibe:"good" },
    { title:"深呼吸 3 次", text:"吸、吐、吸、吐、吸、吐。\n現在你才是你。", vibe:"warn" },
    { title:"把手機擦一下", text:"擦乾淨再抽。\n你擦的是螢幕，也是霉運。", vibe:"good" },
    { title:"先罵一句", text:"隨便罵一句再抽。\n讓壞情緒先出去。", vibe:"warn" },
    { title:"先把肩膀放鬆", text:"你肩膀繃太久了。\n放鬆一下，運氣比較敢靠近。", vibe:"good" },
    { title:"先停 10 秒", text:"別急。\n你越急越容易抽到你不想要的。", vibe:"warn" },
    { title:"先不要抽", text:"今天最好的儀式是：先不抽。\n你先去做一件正事。", vibe:"bad" },
  ];

  // 10) 骰子卜卦（2 顆骰）
  const DICE_MEANINGS = {
    2: { title:"雙一", vibe:"bad",  text:"今天別硬推。\n先把風險壓低。"},
    3: { title:"小歪", vibe:"bad",  text:"你容易被小事影響。\n別把小事放大。"},
    4: { title:"慢熱", vibe:"warn", text:"先暖機。\n事情會慢慢順。"},
    5: { title:"可行", vibe:"warn", text:"可以做，但別貪快。\n一步一步來。"},
    6: { title:"小順", vibe:"good", text:"今天適合推進。\n做一件事就會帶動另一件。"},
    7: { title:"中庸", vibe:"warn", text:"穩。\n你不需要做很多，做對就行。"},
    8: { title:"加速", vibe:"good", text:"你今天效率不錯。\n趁這波把卡關的補一下。"},
    9: { title:"漂亮", vibe:"good", text:"今天做決定會比平常果斷。\n果斷就會省時間。"},
    10:{ title:"上升", vibe:"good", text:"今天會越做越順。\n先做第一步。"},
    11:{ title:"爆擊", vibe:"good", text:"今天很像有 Buff。\n你想做的可以試一下。"},
    12:{ title:"雙六", vibe:"good", text:"今天爽。\n你不做點什麼有點浪費。"},
  };

  // 11) 反向占卜（越抽越嘴臭）
  const REVERSE_LEVELS = [
    [
      "你今天的問題不大。\n你只是想找個理由不做。",
      "你其實知道答案。\n你只是想有人替你下決定。",
      "你不是不行。\n你只是想先抱怨。"
    ],
    [
      "你一直抽，是想抽到你想聽的話。\n那不叫占卜，那叫自我安慰。",
      "你現在的狀態：想做，又怕做。\n怕就別裝勇。",
      "你如果繼續拖，明天的你會更累。\n累了就更容易亂決策。"
    ],
    [
      "你今天最該做的不是抽。\n是去做那件你一直躲的事。",
      "你已經抽很多次了。\n不是宇宙不給你答案，是你不想面對。",
      "你想要奇蹟，但你不想付出。\n你要不要聽聽你自己在講什麼。"
    ]
  ];

  /* ===========================
     Games config
  ============================ */
  const games = [
    { id:"lot",     title:"籤筒抽籤",   desc:"搖一搖，掉出一支籤。正經或怪籤都可能。", badge:"抽籤",   run: () => drawLot(),      icon:"籤", anim:"shake" },
    { id:"doors",   title:"命運三門",   desc:"三扇門選一扇。開門那刻最爽。",           badge:"選擇",   run: () => openDoors(),    icon:"門", anim:"flip"  },
    { id:"tarot",   title:"單張塔羅",   desc:"翻一張。今天的提示一句到位。",           badge:"翻牌",   run: () => drawTarot(),    icon:"牌", anim:"flip"  },
    { id:"orb",     title:"水晶球",     desc:"是 / 否 / 可能 / 再問一次。直白回答。",   badge:"問答",   run: () => askOrb(),       icon:"球", anim:"spin"  },
    { id:"wheel",   title:"關鍵字輪盤", desc:"轉一下，今天的關鍵字直接砸你臉上。",     badge:"轉盤",   run: () => spinKeyword(),  icon:"輪", anim:"spin"  },
    { id:"npc",     title:"NPC 台詞",   desc:"嘴臭或療癒二選一。想被罵或被哄都行。",   badge:"台詞",   run: () => npcLine(),      icon:"嘴", anim:"shake" },
    { id:"gacha",   title:"十連抽",     desc:"純娛樂爽感。看你今天十連長怎樣。",        badge:"抽卡",   run: () => gacha10(),      icon:"十", anim:"spin"  },
    { id:"todo",    title:"適合做/不適合做", desc:"一次給你兩條：今天該做什麼、別做什麼。", badge:"雙條", run: () => doDont(),    icon:"✔", anim:"flip"  },
    { id:"ritual",  title:"抽獎儀式輪盤", desc:"先做一個小儀式再抽，儀式感拉滿。",       badge:"儀式",   run: () => ritualWheel(),  icon:"祭", anim:"spin"  },
    { id:"dice",    title:"骰子卜卦",   desc:"兩顆骰子決定一句話。簡單但很準（娛樂版）。", badge:"骰子", run: () => diceDivine(), icon:"骰", anim:"shake" },
    { id:"reverse", title:"反向占卜",   desc:"越抽越嘴臭。想被罵就進來。還有稱號。",     badge:"嘴臭",   run: () => reverseOracle(),icon:"逆", anim:"shake" },
  ];
  // Per-game reveal animation timings (ms)
  const REVEAL_TIMINGS = {
    lot: 1050,
    doors: 1200,
    tarot: 1300,
    orb: 1400,
    wheel: 1100,
    npc: 900,
    gacha: 1600,
    todo: 1000,
    ritual: 1350,
    dice: 1150,
    reverse: 1250,
  };


  /* ===========================
     Helpers
  ============================ */
  function pickOne(list, rng){ return list[Math.floor(rng() * list.length)]; }
  function vibeClass(v){ if(v==="good") return "good"; if(v==="bad") return "bad"; return "warn"; }
  function vibeBanner(v){ if(v==="good") return "【順】"; if(v==="bad") return "【雷】"; return "【平】"; }

  function incPlay(gameId){
    if(!state.stats.plays) state.stats.plays = {};
    state.stats.plays[gameId] = (state.stats.plays[gameId] || 0) + 1;
    persist();
  }

  function getAchTitles(){
    const p = state.stats.plays || {};
    const reverse = state.stats.reverseCount || 0;
    const total = Object.values(p).reduce((a,b)=>a+b,0);

    const titles = [];
    if(total >= 10) titles.push("新手占卜師");
    if(total >= 50) titles.push("抽不停的人");
    if(total >= 120) titles.push("儀式感專家");
    if((p.gacha || 0) >= 20) titles.push("十連專業戶");
    if((p.doors || 0) >= 20) titles.push("開門成癮者");
    if((p.reverse || 0) >= 10) titles.push("自虐型玩家");
    if(reverse >= 30) titles.push("嘴臭抗性 MAX");
    if(reverse >= 60) titles.push("命運的小丑");
    if(titles.length === 0) titles.push("尚未解鎖稱號");
    return titles;
  }

  /* ===========================
     Record: history & fav
  ============================ */
  function pushHistory(entry){
    state.history.unshift(entry);
    if(state.history.length > 200) state.history.length = 200;
    persist();
    renderHistory();
  }
  function toggleFav(entry){
    const idx = state.fav.findIndex(x => x.key === entry.key);
    if(idx >= 0){
      state.fav.splice(idx,1);
      showToast("已移除收藏");
    }else{
      state.fav.unshift(entry);
      if(state.fav.length > 200) state.fav.length = 200;
      showToast("已加入收藏");
    }
    persist();
    renderFav();
  }
  function isFav(key){ return state.fav.some(x => x.key === key); }

  function persist(){
    LS.save({
      mode: state.mode,
      vibrate: state.vibrate,
      npcMode: state.npcMode,
      history: state.history,
      fav: state.fav,
      stats: state.stats,
    });
    refreshPills();
  }
  function restore(){
    const data = LS.load();
    if(!data) return;
    if(data.mode) state.mode = data.mode;
    if(typeof data.vibrate === "boolean") state.vibrate = data.vibrate;
    if(data.npcMode) state.npcMode = data.npcMode;
    if(Array.isArray(data.history)) state.history = data.history;
    if(Array.isArray(data.fav)) state.fav = data.fav;
    if(data.stats) state.stats = data.stats;
    if(!state.stats.plays) state.stats.plays = {};
    if(typeof state.stats.reverseCount !== "number") state.stats.reverseCount = 0;
  }

  /* ===========================
     Result opener
  ============================ */
  
function uid(){
  // Unique-ish id for history/favorites entries
  return 'id_' + Date.now().toString(36) + '_' + Math.random().toString(36).slice(2, 10);
}


function revealWidget(gameId){
  switch(gameId){
    case "lot":
      return `<div class="revealWidget rw-lot">
        <div class="glow"></div>
        <div class="cap"></div>
        <div class="tube">
          <div class="bambooNodes"></div>
          <div class="bambooGrain"></div>
        </div>
        <div class="slips">
          <div class="slip s3"></div>
          <div class="slip s2"></div>
          <div class="slip s1"></div>
        </div>
      </div>`;
    case "doors":
      return `<div class="revealWidget rw-doors"><div class="glow"></div><div class="door d1"></div><div class="door d2"></div><div class="door d3"></div></div>`;
    case "tarot":
      return `<div class="revealWidget rw-tarot"><div class="glow"></div><div class="deck"></div><div class="card"></div></div>`;
    case "orb":
      return `<div class="revealWidget rw-orb"><div class="glow"></div><div class="ball"><div class="mist"></div></div><div class="base"></div></div>`;
    case "wheel":
      return `<div class="revealWidget rw-wheel"><div class="glow"></div><div class="ptr"></div><div class="wheel"></div><div class="hub"></div></div>`;
    case "dice":
      return `<div class="revealWidget rw-dice"><div class="glow"></div><div class="cube"><span class="pip p1"></span><span class="pip p2"></span><span class="pip p3"></span></div></div>`;
    case "gacha":
      return `<div class="revealWidget rw-gacha"><div class="glow"></div><div class="cards"><div class="c"></div><div class="c"></div><div class="c"></div><div class="c"></div><div class="spark"></div></div></div>`;
    case "todo":
      return `<div class="revealWidget rw-todo"><div class="glow"></div><div class="stamp"><div class="bar"></div><div class="bar b2"></div></div></div>`;
    case "ritual":
      return `<div class="revealWidget rw-ritual"><div class="glow"></div><div class="ring"><div class="sig"></div></div></div>`;
    case "npc":
      return `<div class="revealWidget rw-npc"><div class="glow"></div><div class="bubble"></div><span class="dot d1"></span><span class="dot d2"></span><span class="dot d3"></span></div>`;
    case "reverse":
      return `<div class="revealWidget rw-reverse"><div class="glow"></div><div class="crack"><div class="ink"></div><div class="scan"></div></div></div>`;
    default:
      return `<div class="revealWidget"><div class="glow"></div></div>`;
  }
}


function openResult(gameId, result){
  const d = now();
  const game = games.find(x=>x.id===gameId);
  const gameTitle = (game?.title || gameId);

  // Build a stable entry object for history/fav
  const entry = {
    key: uid(),
    gameId,
    gameTitle,
    title: cleanPhrase(String(result?.title || gameTitle)),
    text: "",
    vibe: result?.vibe || "good",
    at: (d instanceof Date ? d.toISOString() : new Date(d).toISOString()),
  };

  // Remove any trailing tone labels like " · 中性/嘴臭/占卜" etc.
  entry.title = entry.title.replace(/\s*[·・]\s*[^·・]+$/u, "").trim() || gameTitle;

  // Normalize text
  const rawText = (result && typeof result.text !== "undefined") ? String(result.text || "") : "";
  entry.text = rawText
    .split("\n")
    .map(line => cleanPhrase(line))
    .filter(Boolean)
    .join("\n");

  // Push history first (so UI stays consistent even if user closes quickly)
  pushHistory(entry);

  // Build UI HTML (never show tone/mode labels; never prefix with game name)
  const timeStr = fmtTime(entry.at);
  const bodyCore = (result && result._html)
    ? result._html
    : `
      <div class="resultTitle">${escapeHtml(entry.title)}</div>
      <div class="resultText">${escapeHtml(entry.text).replace(/\n/g,"<br>")}</div>
    `;

  const bodyHtml = `
    <div class="resultWrap reveal-${gameId}">
      <div class="resultTop">
        <div class="chip">${escapeHtml(gameTitle)}</div>
        <div class="time mono">${escapeHtml(timeStr)}</div>
      </div>

      <div class="resultCard">
        <div class="revealLayer" id="revealLayer">
          <div class="revealFx">
            <div class="revealTitle">${escapeHtml(gameTitle)}</div>
            <div class="revealSub">抽取中…</div>
            ${revealWidget(gameId)}
          </div>
        </div>

        <div class="resultMain" id="resultMain" style="opacity:0; transform:translateY(6px);">
          ${bodyCore}
        </div>

        <div class="btnRow">
          <button class="btn primary" id="btnAgain">再來一次</button>
          <button class="btn" id="btnFav">${isFav(entry.key) ? "已收藏" : "收藏"}</button>
          <button class="btn" id="btnClose">關閉</button>
        </div>
      </div>
    </div>
  `;

  openSheet(gameTitle, "", bodyHtml);

  // Per-game reveal animation (distinct timing/feel)
  const total = REVEAL_TIMINGS[gameId] || 1100;
  const layer = $("#revealLayer");
  const main  = $("#resultMain");
  if(layer && main){
    // add game-specific class to the reveal layer for CSS-only variations
    layer.classList.add(`fx-${gameId}`);

    setTimeout(()=>{ layer.classList.add("hide"); }, Math.max(200, total-220));
    setTimeout(()=>{ main.style.opacity = "1"; main.style.transform = "translateY(0px)"; }, total);
    setTimeout(()=>{ try{ layer.remove(); }catch(e){} }, total);
  }

  // Bind buttons (guard against missing nodes / dynamic DOM)
  const _root = (typeof sheetBody !== "undefined" && sheetBody && sheetBody.querySelector) ? sheetBody : document;
  const _btnAgain = (_root.querySelector ? _root.querySelector("#btnAgain") : null) || document.querySelector("#btnAgain");
  const _btnFav   = (_root.querySelector ? _root.querySelector("#btnFav")   : null) || document.querySelector("#btnFav");
  const _btnClose = (_root.querySelector ? _root.querySelector("#btnClose") : null) || document.querySelector("#btnClose");

  if(_btnAgain) _btnAgain.onclick = () => { haptic(10); runGame(gameId); };
  if(_btnFav)   _btnFav.onclick   = () => { haptic(10); toggleFav(entry); _btnFav.textContent = isFav(entry.key) ? "已收藏" : "收藏"; };
  if(_btnClose) _btnClose.onclick = () => { haptic(6); closeSheet(); };
}


  function drawLot(){
    incPlay("lot");
    const p = pickPhrase("lot","lot");
    openResult("lot", { title:`籤筒抽籤 · ${toneLabel(p.tone)}`, text:p.text, vibe:"warn" });
  }
  function drawTarot(){
    incPlay("tarot");
    const p = pickPhrase("tarot","tarot");
    openResult("tarot", { title:`單張塔羅 · ${toneLabel(p.tone)}`, text:p.text, vibe:"warn" });
  }
  function askOrb(){
    incPlay("orb");
    const p = pickPhrase("orb","orb");
    openResult("orb", { title:`水晶球 · ${toneLabel(p.tone)}`, text:p.text, vibe:"warn" });
  }
  function spinKeyword(){
    incPlay("wheel");
    const p = pickPhrase("wheel","wheel");
    openResult("wheel", { title:`關鍵字輪盤 · ${toneLabel(p.tone)}`, text:p.text, vibe:"good" });
  }
  function npcLine(){
    incPlay("npc");
    const p = pickPhrase("npc","npc|" + state.npcMode);
    const modeName = (state.npcMode==="soft") ? "療癒" : "嘴臭";
    openResult("npc", { title:`NPC 台詞（${modeName}） · ${toneLabel(p.tone)}`, text:p.text, vibe:(state.npcMode==="soft" ? "good" : "bad") });
  }

  function openDoors(){
    incPlay("doors");
    const rng = getRng("doors");
    const {tone, pool} = getPoolFor("doors", rng);

    // pick 3 unique door outcomes
    const picks = [];
    while(picks.length < 3){
      const t = pickOne(pool, rng);
      if(!picks.includes(t)) picks.push(t);
      if(pool.length <= 3) break;
    }

    openSheet(
      "命運三門",
      `選一扇門（${toneLabel(tone)}）`,
      `
      <div class="resultBox">
        <div class="resultTitle">選一扇門</div>
        <div class="sub">選完就開，不要後悔。語氣：${toneLabel(tone)}（${state.tone==="mix" ? "混合" : state.tone}）</div>
        <div class="grid3" style="margin-top:12px;">
          <button class="cardbtn" id="door1">🚪 左門</button>
          <button class="cardbtn" id="door2">🚪 中門</button>
          <button class="cardbtn" id="door3">🚪 右門</button>
        </div>
        <div class="hint" style="margin-top:12px;">提示：抽到不爽也別翻桌，這只是娛樂。</div>
        <div class="row" style="margin-top:12px; justify-content:flex-end;">
          <button class="btn sm" id="doorClose">關閉</button>
        </div>
      </div>
      `
    );

    const reveal = (i) => {
      closeSheet();
      const text = picks[i];
      openResult("doors", { title:`命運三門 · ${["左門","中門","右門"][i]} · ${toneLabel(tone)}`, text, vibe:"warn" });
    };
    $("#door1").onclick = () => { haptic(14); reveal(0); };
    $("#door2").onclick = () => { haptic(14); reveal(1); };
    $("#door3").onclick = () => { haptic(14); reveal(2); };
    $("#doorClose").onclick = () => closeSheet();
  }

  
  function gacha10(){
    incPlay("gacha");
    const rng = getRng("gacha");

    // 10-card draw with rarity (N/R/SR/SSR)
    const rarityTable = [
      {k:"SSR", w:20, luck:4},
      {k:"SR",  w:20, luck:3},
      {k:"R",   w:30, luck:2},
      {k:"N",   w:30, luck:1},
    ];
    function pickRarity(){
      const total = rarityTable.reduce((a,x)=>a+x.w,0);
      let r = rng() * total;
      for(const it of rarityTable){
        r -= it.w;
        if(r <= 0) return it;
      }
      return rarityTable[rarityTable.length-1];
    }

    const pulls = Array.from({length:10}).map(()=>pickRarity());
    const totalLuck = pulls.reduce((a,x)=>a+x.luck,0);
    const avgLuck = totalLuck / pulls.length;

    // Choose which tone pool to use for the final oracle phrase:
    // - If user explicitly chose A/B/C → follow it
    // - If "mix" → use avgLuck to bias: low→A, mid→B, high→C
    let tone;
    if((state.tone||"mix") !== "mix"){
      tone = getTone(rng);
    }else{
      tone = (avgLuck >= 3.2) ? "C" : (avgLuck >= 2.1 ? "B" : "A");
    }

    const pool = PHRASES.games.gacha.tones[tone];
    const oracle = cleanPhrase(pickOne(pool, rng));

    // Render cards (no tone labels, no luck number shown)
    const bodyHtml = `
      <div class="gachaGrid">
        ${pulls.map((p,i)=>`
          <div class="gachaCard r-${p.k}">
            <div class="gachaR">${p.k}</div>
            <div class="gachaGlow"></div>
          </div>
        `).join("")}
      </div>
      <div class="gachaLuck">幸運值：<span class="mono">${totalLuck}</span></div>
      <div class="gachaOracle">
        <div class="gachaOracleTitle">占卜結果</div>
        <div class="gachaOracleText">${escapeHtml(oracle)}</div>
      </div>
    `;

    openResult("gacha", {
      title:"十連抽",
      text: `幸運值：${totalLuck}\n${oracle}`, // stored in history as plain text
      vibe:"good",
      _html: bodyHtml, // for UI rendering
    });
  }


  function doDont(){
    incPlay("todo");
    const r = pickTodoPair("todo");
    const text = `${r.doText}\n\n${r.dontText}`;
    openResult("todo", { title:`適合做 / 不適合做 · ${toneLabel(r.tone)}`, text, vibe:"warn" });
  }

  function ritualWheel(){
    incPlay("ritual");
    const p = pickPhrase("ritual","ritual");
    openResult("ritual", { title:`抽獎儀式輪盤 · ${toneLabel(p.tone)}`, text:p.text, vibe:"good" });
  }

  function diceDivine(){
    incPlay("dice");
    const rng = getRng("dice");
    const d1 = 1 + Math.floor(rng()*6);
    const d2 = 1 + Math.floor(rng()*6);
    const p = pickPhrase("dice", `dice|${d1}|${d2}`);
    openResult("dice", { title:`骰子卜卦 ${d1}+${d2} · ${toneLabel(p.tone)}`, text:p.text, vibe:"warn" });
  }

  function reverseOracle(){
    incPlay("reverse");
    state.stats.reverseCount = (state.stats.reverseCount || 0) + 1;

    const n = state.stats.reverseCount;
    const st = Math.max(1, Math.min(3, state.reverseStage||1));
    const p = pickPhrase("reverse", `reverse|${st}|${n}`);

    // Stage escalates (cap at 3)
    if(state.reverseStage < 3) state.reverseStage += 1;

    // Title milestones (fun)
    let t = `反向占卜 · 第${st}階段 · ${toneLabel(p.tone)}`;
    if(n === 1) t = `第一次就來自虐？ · 第${st}階段 · ${toneLabel(p.tone)}`;
    else if(n === 10) t = `第十次了，還不去做事？ · 第${st}階段 · ${toneLabel(p.tone)}`;
    else if(n === 30) t = `你已經很能扛嘴臭了 · 第${st}階段 · ${toneLabel(p.tone)}`;
    else if(n === 60) t = `嘴臭抗性 MAX · 第${st}階段 · ${toneLabel(p.tone)}`;

    const extra =
`\n\n（反向占卜累計：${n} 次）\n（進度：第${Math.min(3, state.reverseStage)}階段）\n（稱號：${getAchTitles()[0]}）`;

    persist();
    openResult("reverse", { title: t, text: p.text + extra, vibe: (st===3?"bad": st===2?"warn":"warn") });
  }

  function runGame(id){
    const g = games.find(x=>x.id===id);
    if(!g) return;
    haptic(12);
    g.run();
  }

  /* ===========================
     Render Home game cards
  ============================ */
  function renderHome(){
    elGrid.innerHTML = "";
    for(const g of games){
      const el = document.createElement("div");
      el.className = "card";
      el.innerHTML = `
        <div class="title">${escapeHtml(g.title)}</div>
        <div class="desc">${escapeHtml(g.desc)}</div>
        <div class="row" style="margin-top:10px;">
          <span class="pill">${escapeHtml(g.badge)}</span>
          
        </div>
      `;
      el.onclick = () => runGame(g.id);
      elGrid.appendChild(el);
    }
  }

  /* ===========================
     History & Fav renders
  ============================ */
  function renderHistory(){
    const list = $("#historyList");
    list.innerHTML = "";
    $("#historyEmpty").style.display = state.history.length ? "none" : "";
    state.history.forEach((e) => {
      const d = new Date(e.at);
      const it = document.createElement("div");
      it.className = "item";
      it.innerHTML = `
        <div class="top">
          <span class="badge">${escapeHtml(e.gameTitle || e.gameId)}</span>
          <div class="ttl">${escapeHtml(e.title)}</div>
          <div class="time mono">${fmtDate(d)} ${fmtTime(d)}</div>
        </div>
        <div class="txt">${escapeHtml(e.text)}</div>
        <div class="ops">
          <button class="btn small ${isFav(e.key) ? "" : "ghost"}" data-act="fav" data-key="${escapeAttr(e.key)}">${isFav(e.key) ? "取消收藏" : "收藏"}</button>
          <button class="btn small ghost" data-act="view" data-key="${escapeAttr(e.key)}">查看</button>
          <button class="btn small danger" data-act="del" data-key="${escapeAttr(e.key)}">刪除</button>
        </div>
      `;
      list.appendChild(it);
    });

    list.onclick = (ev) => {
      const btn = ev.target.closest("button");
      if(!btn) return;
      const act = btn.dataset.act;
      const key = btn.dataset.key;
      const entry = state.history.find(x => x.key === key);
      if(!entry) return;

      if(act === "fav"){
        haptic(10);
        toggleFav(entry);
        renderHistory();
      }else if(act === "view"){
        haptic(10);
        openSheet(
          entry.gameTitle,
          `${fmtDate(new Date(entry.at))} ${fmtTime(new Date(entry.at))}`,
          `
          <div class="resultBox">
            <div class="resultTitle">${escapeHtml(entry.title)}</div>
            <div class="resultText">${escapeHtml(entry.text)}</div>
          </div>
          <div class="sheetActions">
            <button class="btn ${isFav(entry.key) ? "" : "ghost"}" id="hvFav">${isFav(entry.key) ? "取消收藏" : "收藏"}</button>
            <button class="btn ghost" id="hvClose">關閉</button>
          </div>
          `
        );
        $("#hvFav").onclick = () => {
          toggleFav(entry);
          renderHistory();
          $("#hvFav").textContent = isFav(entry.key) ? "取消收藏" : "收藏";
        };
        $("#hvClose").onclick = () => closeSheet();
      }else if(act === "del"){
        haptic(14);
        const i = state.history.findIndex(x => x.key === key);
        if(i>=0){
          state.history.splice(i,1);
          persist();
          renderHistory();
          showToast("已刪除");
        }
      }
    };
  }

  function renderFav(){
    const list = $("#favList");
    list.innerHTML = "";
    $("#favEmpty").style.display = state.fav.length ? "none" : "";
    state.fav.forEach((e) => {
      const d = new Date(e.at);
      const it = document.createElement("div");
      it.className = "item";
      it.innerHTML = `
        <div class="top">
          <span class="badge">${escapeHtml(e.gameTitle || e.gameId)}</span>
          <div class="ttl">${escapeHtml(e.title)}</div>
          <div class="time mono">${fmtDate(d)} ${fmtTime(d)}</div>
        </div>
        <div class="txt">${escapeHtml(e.text)}</div>
        <div class="ops">
          <button class="btn small danger" data-act="unfav" data-key="${escapeAttr(e.key)}">移除收藏</button>
          <button class="btn small ghost" data-act="view" data-key="${escapeAttr(e.key)}">查看</button>
        </div>
      `;
      list.appendChild(it);
    });

    list.onclick = (ev) => {
      const btn = ev.target.closest("button");
      if(!btn) return;
      const act = btn.dataset.act;
      const key = btn.dataset.key;
      const entry = state.fav.find(x => x.key === key);
      if(!entry) return;

      if(act === "unfav"){
        haptic(12);
        toggleFav(entry);
        renderFav();
      }else if(act === "view"){
        haptic(10);
        openSheet(
          entry.gameTitle,
          `${fmtDate(new Date(entry.at))} ${fmtTime(new Date(entry.at))}`,
          `
          <div class="resultBox">
            <div class="resultTitle">${escapeHtml(entry.title)}</div>
            <div class="resultText">${escapeHtml(entry.text)}</div>
          </div>
          <div class="sheetActions">
            <button class="btn danger" id="fvUnfav">移除收藏</button>
            <button class="btn ghost" id="fvClose">關閉</button>
          </div>
          `
        );
        $("#fvUnfav").onclick = () => { toggleFav(entry); renderFav(); closeSheet(); };
        $("#fvClose").onclick = () => closeSheet();
      }
    };
  }

  /* ===========================
     Settings sheet (incl. achievements)
  ============================ */
  function openSettings(){
    const d = now();
    const p = state.stats.plays || {};
    const total = Object.values(p).reduce((a,b)=>a+b,0);
    const titles = getAchTitles();

    openSheet(
      "設定",
      `${fmtDate(d)} ${fmtTime(d)}`,
      `
      <div class="resultBox">
        <div class="resultTitle">玩法模式</div>

        <div class="toggleRow">
          <div class="lbl">
            <div class="k">結果模式：每日固定</div>
            <div class="d">同一天、同玩法結果較一致。仍然純單機，不連網。</div>
          </div>
          <div class="switch ${state.mode==="daily" ? "on" : ""}" id="swDaily" aria-label="切換每日固定"></div>
        </div>

        <div class="resultTitle" style="margin-top:14px;">抽到的語氣（A/B/C）</div>
        <div class="sub" style="margin-top:6px;">A=嘴臭直白、B=中性理性、C=占卜玄學。選「混合」會在 A/B/C 間輪流隨機。</div>
        <div class="row" style="margin-top:10px; gap:8px; flex-wrap:wrap;">
          <button class="btn sm ${state.tone==="mix" ? "primary" : ""}" id="toneMix">混合</button>
          <button class="btn sm ${state.tone==="A" ? "primary" : ""}" id="toneA">A 嘴臭</button>
          <button class="btn sm ${state.tone==="B" ? "primary" : ""}" id="toneB">B 中性</button>
          <button class="btn sm ${state.tone==="C" ? "primary" : ""}" id="toneC">C 占卜</button>
        </div>


        <div class="toggleRow">
          <div class="lbl">
            <div class="k">震動回饋</div>
            <div class="d">有支援的手機會震一下，增加儀式感。</div>
          </div>
          <div class="switch ${state.vibrate ? "on" : ""}" id="swVib" aria-label="切換震動"></div>
        </div>

        <div class="toggleRow">
          <div class="lbl">
            <div class="k">NPC 台詞：嘴臭模式</div>
            <div class="d">關掉就變成療癒模式。</div>
          </div>
          <div class="switch ${state.npcMode==="spicy" ? "on" : ""}" id="swNpc" aria-label="切換NPC模式"></div>
        </div>

        <div class="hr"></div>

        <div class="resultTitle">稱號 / 統計（純娛樂）</div>
        <div class="hint">不顯示幸運值，只記錄你玩了幾次，解鎖嘴臭抗性等稱號。</div>

        <div class="kpiRow">
          <div class="kpi"><div class="k">總遊玩次數</div><div class="v mono">${total}</div></div>
          <div class="kpi"><div class="k">反向占卜累計</div><div class="v mono">${state.stats.reverseCount || 0}</div></div>
        </div>

        <div class="hr"></div>
        <div class="resultTitle">已解鎖稱號</div>
        <div class="hint">${escapeHtml(titles.join("、"))}</div>

        <div class="hr"></div>

        <div class="resultTitle" style="margin-top:6px;">資料管理</div>
        <div class="hint">所有資料都只存在本機 localStorage。</div>

        <div class="row" style="margin-top:10px;">
          <button class="btn danger" id="stClearAll">清空全部（歷史+收藏+統計）</button>
          <button class="btn ghost" id="stClose">關閉</button>
        </div>
      </div>
      `
    );

    $("#swDaily").onclick = () => { haptic(10); state.mode = (state.mode==="daily") ? "random" : "daily"; persist(); openSettings(); };
    $("#swVib").onclick = () => { state.vibrate = !state.vibrate; haptic(8); persist(); openSettings(); };
    $("#swNpc").onclick = () => { haptic(10); state.npcMode = (state.npcMode==="spicy") ? "soft" : "spicy"; persist(); openSettings(); };


    $("#toneMix").onclick = () => { haptic(10); state.tone = "mix"; persist(); openSettings(); };
    $("#toneA").onclick   = () => { haptic(10); state.tone = "A";   persist(); openSettings(); };
    $("#toneB").onclick   = () => { haptic(10); state.tone = "B";   persist(); openSettings(); };
    $("#toneC").onclick   = () => { haptic(10); state.tone = "C";   persist(); openSettings(); };

    $("#stClearAll").onclick = () => {
      haptic(16);
      state.history = [];
      state.fav = [];
      state.stats = { plays: {}, reverseCount: 0 };
      persist();
      renderHistory();
      renderFav();
      showToast("已清空");
      closeSheet();
    };
    $("#stClose").onclick = () => closeSheet();
  }

  function refreshPills(){
    $("#pillMode").textContent = `模式：${state.mode==="daily" ? "每日固定" : "純隨機"}`;
    $("#pillVibe").textContent = `震動：${state.vibrate ? "開" : "關"}`;
    $("#pillNpc").textContent = `NPC：${state.npcMode==="spicy" ? "嘴臭" : "療癒"}`;
  }

  /* ===========================
     Export helpers
  ============================ */
  function downloadJson(filename, obj){
    const blob = new Blob([JSON.stringify(obj, null, 2)], {type:"application/json;charset=utf-8"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
  }

  /* ===========================
     Events
  ============================ */
  $("#btnCloseSheet").onclick = () => closeSheet();
  overlay.addEventListener("click", (e) => { if(e.target === overlay) closeSheet(); });

  $("#btnSettings").onclick = () => { haptic(10); openSettings(); };
  $("#btnBack").onclick = () => { haptic(8); showView("home"); };

  $("#tabHome").onclick = () => { haptic(8); showView("home"); };
  $("#tabHistory").onclick = () => { haptic(8); showView("history"); renderHistory(); };
  $("#tabFav").onclick = () => { haptic(8); showView("fav"); renderFav(); };

  $("#btnOpenHistory").onclick = () => { haptic(8); showView("history"); renderHistory(); };
  $("#btnOpenFav").onclick = () => { haptic(8); showView("fav"); renderFav(); };

  $("#btnQuickRandom").onclick = () => {
    haptic(10);
    const rng = getRng("quick");
    const g = games[Math.floor(rng() * games.length)];
    runGame(g.id);
  };

  $("#btnClearHistory").onclick = () => {
    haptic(16);
    state.history = [];
    persist();
    renderHistory();
    showToast("已清空歷史");
  };
  $("#btnClearFav").onclick = () => {
    haptic(16);
    state.fav = [];
    persist();
    renderFav();
    showToast("已清空收藏");
  };

  $("#btnExportHistory").onclick = () => {
    haptic(10);
    downloadJson(`luck_history_${fmtDate(now())}.json`, state.history);
    showToast("已匯出歷史 JSON");
  };
  $("#btnExportFav").onclick = () => {
    haptic(10);
    downloadJson(`luck_fav_${fmtDate(now())}.json`, state.fav);
    showToast("已匯出收藏 JSON");
  };

  /* ===========================
     Escaping
  ============================ */
  
function cleanPhrase(s){
  s = String(s||"").trim();

  // 1) 移除反向占卜階段/序號前綴，如 A1-3：、B2-10：
  s = s.replace(/^[ABC]\d-\d+：\s*/,"");

  // 2) 移除常見標籤前綴（不顯示語氣/模式/來源）
  s = s.replace(/^(NPC低語|守護訊息|NPC|水晶球|籤筒抽籤|命運三門|單張塔羅|十連抽|抽獎儀式|骰子卜卦|適合\/不適合)\s*[：／]\s*/,"");

  // 3) 若仍有「短前綴：」格式，且前綴很短（<=8字），視為標籤直接去掉
  s = s.replace(/^([^\s：]{1,8})：\s*/,(m,p1)=>"");

  // 4) 移除尾端「（遊戲名）」這類標註
  s = s.replace(/（[^（）]{1,10}）\s*$/,"").trim();

  // 5) 移除殘留的語氣字樣與多餘分隔符
  s = s.replace(/\b(嘴臭|中性|占卜|混合)\b/g,"").replace(/\s*·\s*/g," ").replace(/\s{2,}/g," ").trim();

  return s;
}


function stripHtmlToText(html){
  const tmp = document.createElement("div");
  tmp.innerHTML = String(html||"");
  return (tmp.textContent || tmp.innerText || "").trim();
}

function escapeHtml(s){
    return String(s)
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#39;");
  }
  function escapeAttr(s){ return escapeHtml(s).replaceAll("\n"," "); }

  /* ===========================
     Init
  ============================ */
  restore();
  renderHome();
  refreshPills();
  showView("home");

})();
</script>
</body>
</html>
